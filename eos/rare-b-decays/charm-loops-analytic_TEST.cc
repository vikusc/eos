/* vim: set sw=4 sts=4 et foldmethod=syntax : */

/*
 * Copyright (c) 2022 Viktor Kuschke
 *
 * This file is part of the EOS project. EOS is free software;
 * you can redistribute it and/or modify it under the terms of the GNU General
 * Public License version 2, as published by the Free Software Foundation.
 *
 * EOS is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
 * details.
 *
 * You should have received a copy of the GNU General Public License along with
 * this program; if not, write to the Free Software Foundation, Inc., 59 Temple
 * Place, Suite 330, Boston, MA  02111-1307  USA
 */

#include <test/test.hh>
#include <eos/rare-b-decays/charm-loops.hh>

#include <cmath>

using namespace test;
using namespace eos;
using namespace agv_2019a;

class LoopParameterTest :
    public TestCase
{
    public:
        LoopParameterTest() :
            TestCase("loop_parameter_test")
        {
        }

        virtual void run() const
        {
            {
                static const double eps = 1e-12;
                const complex<double> myi(0.0, 1.0);
                agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ -4.0, /*z =*/ 0.15, /*feynepsilonhat*/ 1e-10};

                /* Check, that the square root in C++ of complex arguments is handled correctly */

                static const complex<double> m1(-1.0, 0.0);
                TEST_CHECK_NEARLY_EQUAL(0.0,     std::sqrt(m1).real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.0,     std::sqrt(m1).imag(), eps);

                /* Comparison with Mathematica results */

                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_a.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.7745966689726898,     testclp.x_b.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_c.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.7745966689726898,     testclp.x_d.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_e.real(), eps);

                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_a.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.6324555318142068,     testclp.x_b.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_c.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.6324555318142068,     testclp.x_d.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_e.imag(), eps);

                /* Check, that the logarithm of complex numbers with negative real part is consistent with Mathematica */

                const double s_list[9] = {-1.0, -7.0 / 9.0, -5.0 / 9.0, -1.0 / 3.0, -1.0 / 9.0, 1.0 / 9.0, 1.0 / 3.0, 5.0 / 9.0, 7.0 / 9.0};
                const complex<double> lnms_ref[9] = {5.0000000000000005e-21 + 1.e-10 * myi,-0.25131442828090605 + 1.e-10 * myi,-0.587786664902119 + 1.e-10 * myi,-1.0986122886681096 + 1.0000000000000002e-10 * myi,-2.197224577336219 + 1.e-10 * myi,-2.19722457733622 - 3.141592653489793 * myi,-1.09861228866811 - 3.141592653489793 * myi,-0.5877866649021192 - 3.141592653489793 * myi,-0.2513144282809062 - 3.141592653489793 * myi};

                for (unsigned int i = 0; i < 9; i++)
                {
                    const double s = s_list[i];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ 0.15, /*feynepsilonhat*/ 1e-10};
                    const complex<double> lnms = std::log(-testclp.s_eps);

                    TEST_CHECK_NEARLY_EQUAL(lnms_ref[i].real(), lnms.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(lnms_ref[i].imag(), lnms.imag(), eps);
                }
            }
        }
} loop_parameter_test ;

class TwoLoopTest :
    public TestCase
{
    public:
        TwoLoopTest() :
            TestCase("two_loop_test")
        {
        }

        virtual void run() const
        {
            static double eps = 1e-12;
            const complex<double> myi(0.0, 1.0);
            const double z_s_list[45][2] = {{0.05, -1.0},     {0.05, -7.0 / 9.0},    {0.05, -5.0 / 9.0},    {0.05, -1.0 / 3.0},    {0.05, -1.0 / 9.0},  {0.05, 1.0 / 9.0},  {0.05, 1.0 / 3.0},  {0.05, 5.0 / 9.0},  {0.05, 7.0 / 9.0},
                                            {0.075, -1.0},    {0.075, -7.0 / 9.0},   {0.075, -5.0 / 9.0},   {0.075, -1.0 / 3.0},   {0.075, -1.0 / 9.0}, {0.075, 1.0 / 9.0}, {0.075, 1.0 / 3.0}, {0.075, 5.0 / 9.0}, {0.075, 7.0 / 9.0},
                                            {0.1, -1.0},      {0.1, -7.0 / 9.0},     {0.1, -5.0 / 9.0},     {0.1, -1.0 / 3.0},     {0.1, -1.0 / 9.0},   {0.1, 1.0 / 9.0},   {0.1, 1.0 / 3.0},   {0.1, 5.0 / 9.0},   {0.1, 7.0 / 9.0},
                                            {0.125, -1.0},    {0.125, -7.0 / 9.0},   {0.125, -5.0 / 9.0},   {0.125, -1.0 / 3.0},   {0.125, -1.0 / 9.0}, {0.125, 1.0 / 9.0}, {0.125, 1.0 / 3.0}, {0.125, 5.0 / 9.0}, {0.125, 7.0 / 9.0},
                                            {0.15, -1.0},     {0.15, -7.0 / 9.0},    {0.15, -5.0 / 9.0},    {0.15, -1.0 / 3.0},    {0.15, -1.0 / 9.0},  {0.15, 1.0 / 9.0},  {0.15, 1.0 / 3.0},  {0.15, 5.0 / 9.0},  {0.15, 7.0 / 9.0}};

            // Counterterms
            {

                // The computation took 1.090361s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f17ct_ref[45] = {0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi};

                // The computation took 5.23546s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f19ct_ref[45] = {-2.7747020877105797+5.626346304045955e-9*myi,-3.678411078930253+6.551498509238362e-9*myi,-5.189029077982212+7.622673015584751e-9*myi,-8.082810669902756+8.358442082775868e-9*myi,-15.295431631415227+4.10848830837457e-9*myi,-54.58909756932087-0.2962036019425178*myi,70.55799350353001-17.653390450324757*myi,30.565735956813924+5.7665720781398235*myi,18.123518226961437+8.16568053415471*myi,-3.893962954910876+3.6667442484171744e-9*myi,-4.9435312452224025+4.047484854303513e-9*myi,-6.590976326253326+4.3029628743453725e-9*myi,-9.469670526543581+3.875115198659835e-9*myi,-15.549077574087107-2.327794826955606e-10*myi,-34.693573875853275-0.29620348722185535*myi,167.92305609469395-169.05788651872777*myi,52.46869793945905-5.200967465309851*myi,29.684631469279182+5.682142901544971*myi,-4.6121577307674215+2.4686952677874505e-9*myi,-5.708816327234217+2.5808340482679426e-9*myi,-7.354933349386755+2.490392924813179e-9*myi,-10.05051056855254+1.734163658380889e-9*myi,-15.153979279758971-1.5672712814544838e-9*myi,-27.418279308218146-0.2962034663408389*myi,-106.01160307383219-0.18257783824640594*myi,84.59645934900874-33.95940219738226*myi,43.98892291368844-0.5735255289875738*myi,-5.072667438223817+1.6824488080230685e-9*myi,-6.166265303521357+1.655473734962947e-9*myi,-7.751673931711565+1.4166070071917854e-9*myi,-10.22260815512277+6.081296126569895e-10*myi,-14.548968500514661-1.9781302920086277e-9*myi,-23.33010199275789-0.2962034587959605*myi,-53.38314519171202-0.18257745555047408*myi,153.5213258190528-140.2100221981614*myi,62.635938975007846-13.392627642880836*myi,-5.357791346984698+1.1439296343338859e-9*myi,-6.42217138552391+1.0446350252241993e-9*myi,-7.922209335544608+7.481806136477017e-10*myi,-10.170139590163245-1.6911948663200337e-11*myi,-13.881352337142118-2.052076503827342e-9*myi,-20.571120817214762-0.29620345513394997*myi,-37.880978841112146-0.18257740232203398*myi,-180.21214469438945-0.1297454551302265*myi,89.84030337463037-40.709145314441294*myi};
                /*
                const complex<double> f19ctQs_ref[45] = {-0.02047662258503148+2.194787379972565e-12*myi,-0.02703209330497716+3.0221599833664946e-12*myi,-0.039064420389798245+4.129887511337566e-12*myi,-0.06445629905751535+5.811617959949882e-12*myi,-0.14817092074193602+9.428448539927197e-12*myi,0.014291703133965751-0.2962034466684186*myi,0.09800632481838653-0.18257736287867887*myi,0.12339820348610364-0.12974424265357343*myi,0.13543053057092472-0.09494395601415015*myi,-0.02047662258503148+2.194787379972565e-12*myi,-0.02703209330497716+3.0221599833664946e-12*myi,-0.039064420389798245+4.129887511337566e-12*myi,-0.06445629905751535+5.811617959949882e-12*myi,-0.14817092074193602+9.428448539927197e-12*myi,0.014291703133965751-0.2962034466684186*myi,0.09800632481838653-0.18257736287867887*myi,0.12339820348610364-0.12974424265357343*myi,0.13543053057092472-0.09494395601415015*myi,-0.02047662258503148+2.194787379972565e-12*myi,-0.02703209330497716+3.0221599833664946e-12*myi,-0.039064420389798245+4.129887511337566e-12*myi,-0.06445629905751535+5.811617959949882e-12*myi,-0.14817092074193602+9.428448539927197e-12*myi,0.014291703133965751-0.2962034466684186*myi,0.09800632481838653-0.18257736287867887*myi,0.12339820348610364-0.12974424265357343*myi,0.13543053057092472-0.09494395601415015*myi,-0.02047662258503148+2.194787379972565e-12*myi,-0.02703209330497716+3.0221599833664946e-12*myi,-0.039064420389798245+4.129887511337566e-12*myi,-0.06445629905751535+5.811617959949882e-12*myi,-0.14817092074193602+9.428448539927197e-12*myi,0.014291703133965751-0.2962034466684186*myi,0.09800632481838653-0.18257736287867887*myi,0.12339820348610364-0.12974424265357343*myi,0.13543053057092472-0.09494395601415015*myi,-0.02047662258503148+2.194787379972565e-12*myi,-0.02703209330497716+3.0221599833664946e-12*myi,-0.039064420389798245+4.129887511337566e-12*myi,-0.06445629905751535+5.811617959949882e-12*myi,-0.14817092074193602+9.428448539927197e-12*myi,0.014291703133965751-0.2962034466684186*myi,0.09800632481838653-0.18257736287867887*myi,0.12339820348610364-0.12974424265357343*myi,0.13543053057092472-0.09494395601415015*myi};
                const complex<double> f19ctQb_ref[45] = {-0.03362116035850015-6.473045555860073e-13*myi,-0.03217826028806952-5.064972093882494e-13*myi,-0.03072736964049131-3.6359379700021117e-13*myi,-0.029270125586471442-2.1896470767350776e-13*myi,-0.027808630295338983-7.31389502765946e-14*myi,-0.026345582195269716+7.313488016897703e-14*myi,-0.024884451200584877+2.1881905512532127e-13*myi,-0.023429715763803476+3.62442137811981e-13*myi,-0.021987188391584485+5.019260813502617e-13*myi,-0.03362116035850015-6.473045555860073e-13*myi,-0.03217826028806952-5.064972093882494e-13*myi,-0.03072736964049131-3.6359379700021117e-13*myi,-0.029270125586471442-2.1896470767350776e-13*myi,-0.027808630295338983-7.31389502765946e-14*myi,-0.026345582195269716+7.313488016897703e-14*myi,-0.024884451200584877+2.1881905512532127e-13*myi,-0.023429715763803476+3.62442137811981e-13*myi,-0.021987188391584485+5.019260813502617e-13*myi,-0.03362116035850015-6.473045555860073e-13*myi,-0.03217826028806952-5.064972093882494e-13*myi,-0.03072736964049131-3.6359379700021117e-13*myi,-0.029270125586471442-2.1896470767350776e-13*myi,-0.027808630295338983-7.31389502765946e-14*myi,-0.026345582195269716+7.313488016897703e-14*myi,-0.024884451200584877+2.1881905512532127e-13*myi,-0.023429715763803476+3.62442137811981e-13*myi,-0.021987188391584485+5.019260813502617e-13*myi,-0.03362116035850015-6.473045555860073e-13*myi,-0.03217826028806952-5.064972093882494e-13*myi,-0.03072736964049131-3.6359379700021117e-13*myi,-0.029270125586471442-2.1896470767350776e-13*myi,-0.027808630295338983-7.31389502765946e-14*myi,-0.026345582195269716+7.313488016897703e-14*myi,-0.024884451200584877+2.1881905512532127e-13*myi,-0.023429715763803476+3.62442137811981e-13*myi,-0.021987188391584485+5.019260813502617e-13*myi,-0.03362116035850015-6.473045555860073e-13*myi,-0.03217826028806952-5.064972093882494e-13*myi,-0.03072736964049131-3.6359379700021117e-13*myi,-0.029270125586471442-2.1896470767350776e-13*myi,-0.027808630295338983-7.31389502765946e-14*myi,-0.026345582195269716+7.313488016897703e-14*myi,-0.024884451200584877+2.1881905512532127e-13*myi,-0.023429715763803476+3.62442137811981e-13*myi,-0.021987188391584485+5.019260813502617e-13*myi};
                const complex<double> f19ctQsQb_ref[45] = {-0.0540977829435316+1.5474828243865593e-12*myi,-0.05921035359304663+2.5156627739782463e-12*myi,-0.06979179003028964+3.766293714337352e-12*myi,-0.09372642464398685+5.592653252276379e-12*myi,-0.17597955103727464+9.355309589650604e-12*myi,-0.01205387906130409-0.2962034466683454*myi,0.07312187361780165-0.18257736287846005*myi,0.09996848772230019-0.129744242653211*myi,0.11344334217934025-0.09494395601364823*myi,-0.0540977829435316+1.5474828243865593e-12*myi,-0.05921035359304663+2.5156627739782463e-12*myi,-0.06979179003028964+3.766293714337352e-12*myi,-0.09372642464398685+5.592653252276379e-12*myi,-0.17597955103727464+9.355309589650604e-12*myi,-0.01205387906130409-0.2962034466683454*myi,0.07312187361780165-0.18257736287846005*myi,0.09996848772230019-0.129744242653211*myi,0.11344334217934025-0.09494395601364823*myi,-0.0540977829435316+1.5474828243865593e-12*myi,-0.05921035359304663+2.5156627739782463e-12*myi,-0.06979179003028964+3.766293714337352e-12*myi,-0.09372642464398685+5.592653252276379e-12*myi,-0.17597955103727464+9.355309589650604e-12*myi,-0.01205387906130409-0.2962034466683454*myi,0.07312187361780165-0.18257736287846005*myi,0.09996848772230019-0.129744242653211*myi,0.11344334217934025-0.09494395601364823*myi,-0.0540977829435316+1.5474828243865593e-12*myi,-0.05921035359304663+2.5156627739782463e-12*myi,-0.06979179003028964+3.766293714337352e-12*myi,-0.09372642464398685+5.592653252276379e-12*myi,-0.17597955103727464+9.355309589650604e-12*myi,-0.01205387906130409-0.2962034466683454*myi,0.07312187361780165-0.18257736287846005*myi,0.09996848772230019-0.129744242653211*myi,0.11344334217934025-0.09494395601364823*myi,-0.0540977829435316+1.5474828243865593e-12*myi,-0.05921035359304663+2.5156627739782463e-12*myi,-0.06979179003028964+3.766293714337352e-12*myi,-0.09372642464398685+5.592653252276379e-12*myi,-0.17597955103727464+9.355309589650604e-12*myi,-0.01205387906130409-0.2962034466683454*myi,0.07312187361780165-0.18257736287846005*myi,0.09996848772230019-0.129744242653211*myi,0.11344334217934025-0.09494395601364823*myi};
                const complex<double> f19ctQc_ref[45] = {-2.720604304767022+5.6247980315480275e-9*myi,-3.6192007253371514+6.548985199820776e-9*myi,-5.119237287951904+7.61890835608698e-9*myi,-7.989084245258777+8.352848807905015e-9*myi,-15.119452080377933+4.099132545221309e-9*myi,-54.57704369025958-1.5527416938828098e-7*myi,70.48487162991219-17.470813087446288*myi,30.46576746909163+5.896316320793041*myi,18.010074884782085+8.260624490168361*myi,-3.8398651719673325+3.66519597591926e-9*myi,-4.884320891629304+4.04497154488592e-9*myi,-6.5211845362230285+4.2991982148476054e-9*myi,-9.375944101899595+3.869521923788992e-9*myi,-15.373098023049863-2.4213524584880804e-10*myi,-34.68151999679196-4.055350691496957e-8*myi,167.84993422107613-168.8753091558493*myi,52.368729451736755-5.071223222656641*myi,29.571188127099845+5.777086857558622*myi,-4.558059947823901+2.4671469952895393e-9*myi,-5.649605973641151+2.5783207388503503e-9*myi,-7.285141559356472+2.4866282653154103e-9*myi,-9.956784143908553+1.7285703835100425e-9*myi,-14.977999728721642-1.5766270446077379e-9*myi,-27.406225429156848-1.967249045742439e-8*myi,-106.08472494745-4.753679427774418e-7*myi,84.49649086128643-33.82965795472904*myi,43.8754795715091-0.4785815729739298*myi,-5.018569655280334+1.680900535525154e-9*myi,-6.107054949928312+1.6529604255453546e-9*myi,-7.681882141681239+1.4128423476940216e-9*myi,-10.128881730478748+6.025363377861447e-10*myi,-14.37298894947736-1.9874860551618884e-9*myi,-23.31804811369661-1.212760852319982e-8*myi,-53.45626706532982-9.267200735345733e-8*myi,153.42135733133054-140.08027795550817*myi,62.52249563282852-13.297683686867188*myi,-5.303693564041179+1.1423813618359747e-9*myi,-6.362961031930883+1.0421217158066053e-9*myi,-7.852417545514282+7.44415954149938e-10*myi,-10.076413165519217-2.2505223534046826e-11*myi,-13.705372786104867-2.061432266980596e-9*myi,-20.559066938153485-8.46560153424209e-9*myi,-37.95410071472995-3.944357080457348e-8*myi,-180.31211318211174-1.2124770164971813e-6*myi,89.72686003245104-40.61420135842765*myi};
                */

                // The computation took 1.08506s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f27ct_ref[45] = {-0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi};

                // The computation took 5.27316s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f29ct_ref[45] = {-1.608986716471776+3.934295499979576e-9*myi,-2.3693283777971317+4.271854880838442e-9*myi,-3.7800190331181796+4.402372917703126e-9*myi,-6.599376801954662+3.5067631829492385e-9*myi,-13.404671606463694-3.753818639220557e-9*myi,-50.98081440086062+1.7772205299757942*myi,52.76153897156211-38.65385854966077*myi,34.66130927641784-12.829931777947536*myi,29.017679457734744-5.407202046720414*myi,-2.401870228870557+2.652835236941801e-9*myi,-3.1817692982717034+2.698718235901337e-9*myi,-4.538488326070166+2.4507032774885e-9*myi,-7.036633206233375+1.244260771205401e-9*myi,-12.213990799607984-3.984122385193444e-9*myi,-30.90700561930492+1.7772206377857764*myi,107.16140038893903-148.86783796939537*myi,46.114443570219464-23.70169235520142*myi,35.328110799930535-9.590736456099371*myi,-2.9414233745675844+1.8750311194276108e-9*myi,-3.6918220890152753+1.7933824848964267e-9*myi,-4.938908656081523+1.4262694196122121e-9*myi,-7.0986719328511185+2.821701102354999e-10*myi,-11.102215787231103-3.4649922257079255e-9*myi,-23.22044639006853+1.7772206593931228*myi,-89.78355190008688+1.0954637858202039*myi,62.98816795440386-46.82941116582578*myi,42.92255440219149-16.42890162479344*myi,-3.3211858277453743+1.3656343000405952e-9*myi,-4.021094256914381+1.2293665602458048e-9*myi,-5.1442919083031455+8.41362748745472e-10*myi,-6.997705859671058-1.5657051029408877e-10*myi,-10.142144919941671-2.905822344058433e-9*myi,-18.936989330517427+1.7772206675965885*myi,-45.21119817675006+1.0954640964488*myi,102.8561882200495-124.64515483844737*myi,52.751369875880215-27.83701399063691*myi,-3.5939711464536828+1.0157641805518302e-9*myi,-4.235378448263781+8.599867522896628e-10*myi,-5.23645786793729+4.89817231583082e-10*myi,-6.824324716574154-3.572393189764593e-10*myi,-9.323332766521304-2.4259036057229785e-9*myi,-16.137135778031848+1.777220671669935*myi,-31.4613064877505+1.0954641421398201*myi,-146.15081645857504+0.7784645027656028*myi,67.4668671122318-49.36283092562938*myi};
                //const complex<double> f29ctQc_ref[45] = {-1.9335734141329581+3.943578029539688e-9*myi,-2.724590499355415+4.286948948198712e-9*myi,-4.198769773299915+4.424975085544435e-9*myi,-7.161735349818564+3.5403228321743026e-9*myi,-14.46054891268734-3.697684060300993e-9*myi,-51.05313767522844-1.5003427507707025e-7*myi,53.20027021326892-39.74932272693152*myi,35.26112020275164-13.608397233866803*myi,29.69833951081079-5.976865782802296*myi,-2.7264569265317604+2.662121319215599e-9*myi,-3.5370314198299795+2.7138123032616047e-9*myi,-4.957239066251908+2.473301892616133e-9*myi,-7.598991754097284+1.277816867716788e-9*myi,-13.269868105831607-3.927991358987566e-9*myi,-30.979328893672736-4.2224296104773234e-8*myi,107.60013163064583-149.96330214666614*myi,46.71425449655327-24.480157811120684*myi,36.00877085300658-10.160400192181257*myi,-3.2660100722287737+1.88431364898773e-9*myi,-4.047084210573548+1.8084765522566952e-9*myi,-5.357659396263255+1.4488680347398449e-9*myi,-7.66103048071503+3.1572620674688516e-10*myi,-12.158093093454724-3.4088611995020403e-9*myi,-23.292769664436342-2.061694975376436e-8*myi,-89.34482065838006-3.914505573795471e-7*myi,63.58797888073767-47.60787662174505*myi,43.60321445526753-16.998565360875325*myi,-3.645772525406567+1.3749168296007135e-9*myi,-4.376356378472668+1.2444606276060733e-9*myi,-5.563042648484892+8.639578111594259e-10*myi,-7.560064407534957-1.2301796649638068e-10*myi,-11.198022226165328-2.849694870566228e-9*myi,-19.009312604885245-1.241348748937621e-8*myi,-44.77246693504325-8.082196483957874e-8*myi,103.4559991463833-125.42362029436664*myi,53.43202992895627-28.406677726718797*myi,-3.918557844114874+1.0250467101119497e-9*myi,-4.590640569822064+8.750808196499307e-10*myi,-5.655208608119036+5.124158467107139e-10*myi,-7.386683264438066-3.236832224650724e-10*myi,-10.379210072744964-2.3697725795171e-9*myi,-16.20945905239966-8.34013765965777e-9*myi,-31.022575246043694-3.513094109142863e-8*myi,-145.55100553224125-9.531536642340247e-7*myi,68.14752716530782-49.93249466171127*myi};

                for (unsigned int i = 0; i < 45; i++)
                {
                    const double z = z_s_list[i][0];
                    const complex<double> s = z_s_list[i][1];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ z, /*feynepsilonhat*/ 1e-10};

                    const complex<double> f17ct = agv_2019a::f17ctQs(testclp) + agv_2019a::f17ctQc(testclp) + agv_2019a::f17ctQb(testclp);
                    const complex<double> f19ct = agv_2019a::f19ctQs(testclp) + agv_2019a::f19ctQc(testclp) + agv_2019a::f19ctQb(testclp);
                    const complex<double> f27ct = agv_2019a::f27ctQs(testclp) + agv_2019a::f27ctQc(testclp) + agv_2019a::f27ctQb(testclp);
                    const complex<double> f29ct = agv_2019a::f29ctQs(testclp) + agv_2019a::f29ctQc(testclp) + agv_2019a::f29ctQb(testclp);

                    TEST_CHECK_NEARLY_EQUAL(f17ct_ref[i].real(), f17ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f17ct_ref[i].imag(), f17ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f19ct_ref[i].real(), f19ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f19ct_ref[i].imag(), f19ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f27ct_ref[i].real(), f27ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f27ct_ref[i].imag(), f27ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f29ct_ref[i].real(), f29ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f29ct_ref[i].imag(), f29ct.imag(), eps);
                }
            }

            // Two loop functions
            {
                static double eps = 1e-12;

                // The computation took 38.0936s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f27c_ref[45] = {1.6791188931480354+0.176035647094692*myi,1.8445207172828009+0.22491670644554373*myi,2.039637263807971+0.29730968194630775*myi,2.272896086709195+0.41084782274089404*myi,2.549536785805979+0.601808734589645*myi,2.827806363319306+0.9245760968901244*myi,3.0754663141059595+1.7691695215566483*myi,2.6058034231749705+2.181421117441232*myi,2.279797531379785+2.350344220275119*myi,1.484743676467711+0.11361500496449817*myi,1.6269481151672336+0.14452145433548835*myi,1.793156719131109+0.18988086952137584*myi,1.9904759809253152+0.2601102467789501*myi,2.2257045229267924+0.37613871047342284*myi,2.4857658838282046+0.5765911372455763*myi,3.1416997323708813+0.7601944755598984*myi,2.8440086840698187+1.725913168485203*myi,2.4961456676789524+2.046984350070474*myi,1.3168845149308028+0.07081490948937363*myi,1.4401326832344288+0.08983704116886254*myi,1.582817619753906+0.11762279270003301*myi,1.7508368251793547+0.16039324744905237*myi,1.9511183497668894+0.23067496202722326*myi,2.1833585326977936+0.35426411305347916*myi,2.3452983398140606+0.5171740670821414*myi,2.977072733932623+1.1206774043534402*myi,2.6724361288312366+1.6750448942107994*myi,1.16957799802036+0.04166580412826543*myi,1.2770492135049047+0.052777116063518335*myi,1.4002120709097787+0.06897286248920559*myi,1.5438511429916377+0.09385314550921109*myi,1.714290631468566+0.13474026970042674*myi,1.9165961456360656+0.20774456244040174*myi,2.120944344168538+0.34227779599615715*myi,2.8233710535070475+0.26928476879405494*myi,2.7856818014716183+1.2184027574251957*myi,1.0390818597513611+0.02237301526240776*myi,1.1333078877013394+0.028317910732284512*myi,1.2401166856635362+0.036977789310918*myi,1.3632657540420463+0.05028109592823782*myi,1.5080618886040846+0.07219171884337117*myi,1.6810035995398285+0.11178669807703567*myi,1.8794068499956147+0.19171297494068718*myi,1.8932930155997258+0.26923528871960656*myi,2.7836870826023272+0.6523003925748014*myi};
                //const complex<double> f27cParts12_ref[45] = {3.0187179563223463+0.45900998965201495*myi,3.28322223933087+0.5985844971851075*myi,3.583141154041552+0.8141731271516961*myi,3.904934239868754+1.1749790169004346*myi,4.150651492249223+1.8589201128976045*myi,3.470653365759114+3.535527793754005*myi,1.8153221256882852+0.07850997173087304*myi,2.983649293273597-2.3227744031381317*myi,7.117348398795418-19.13967267690022*myi,3.175215406612272+0.4042402449330863*myi,3.435557425432233+0.5278241564659766*myi,3.729583555976668+0.71852813600029*myi,4.047257704304342+1.0362754237359768*myi,4.317826089907886+1.6294301318012563*myi,4.077634199829938+2.978917888564899*myi,-1.9930266735991768-0.773042878615624*myi,1.0485808620868795-5.390685713356612*myi,1.3753655832485912-38.18286134001379*myi,3.270655006265039+0.3376716837887724*myi,3.5234166269646563+0.44169671319815085*myi,3.8091538644217673+0.6022594762385313*myi,4.122752676202144+0.8692491534355968*myi,4.418450886661214+1.3633940055048592*myi,4.420579848751769+2.4494087397249045*myi,1.2894721238832565+5.921983131366252*myi,-3.3628514646944243-7.9705889710822575*myi,-13.67026892577384-59.48359806022344*myi,3.322306340175248+0.2666870281434631*myi,3.564635168714416+0.3496190916134433*myi,3.839180871022962+0.4777659912524028*myi,4.145393875270583+0.6907667889330888*myi,4.457388623001634+1.083184924932218*myi,4.610933408116583+1.929823889386165*myi,3.346032945141583+4.364306578210347*myi,-12.716395068121162-7.866393343026765*myi,-40.988918492822755-79.11313716976221*myi,3.340126216513948+0.1961963337128117*myi,3.5693155097252007+0.25787852114346077*myi,3.8292338899712277+0.3533568597055835*myi,4.122694242030798+0.5121722384854568*myi,4.4379043565960234+0.8041629971708638*myi,4.678906806066162+1.4276485681905267*myi,4.1453924724246205+3.1412464230953248*myi,-7.673798458762949+11.721574504163408*myi,-84.25354711782842-89.78468334019367*myi};
                //const complex<double> f27cParts1234_ref[45] = {1.682123382954901+0.18269718132082446*myi,1.8468597393719395+0.22981012971809167*myi,2.040289481226079+0.2986064522058516*myi,2.2703235496886434+0.4059334969634605*myi,2.544241970309372+0.5918791584718637*myi,2.8621101426061037+0.9926440102312986*myi,2.1369315559911923+2.0623585817841317*myi,-1.3870214766893767+1.9516635439134769*myi,-35.84612460102643-6.784761922893249*myi,1.491104710398326+0.1219094018759157*myi,1.631765474651551+0.1505378086216791*myi,1.7944572980150606+0.19144509028765144*myi,1.9855611870452519+0.25437066998915325*myi,2.2162858423518244+0.365298286679018*myi,2.5348004592243196+0.6343212247724637*myi,1.8091224537507085+2.918576067103287*myi,-4.470311029702316+4.495954712426013*myi,-70.47075172922362+10.450192409236415*myi,1.3265292253257979+0.07935145110328667*myi,1.4473270319966298+0.09596717919505304*myi,1.584722780245151+0.11919341510554338*myi,1.7438303690955514+0.1547637998838054*myi,1.9382820911602554+0.22049981912417382*myi,2.243506836614239+0.402523533695502*myi,3.653278685270915+1.6857553848963942*myi,-6.668371436677969+10.564631416127433*myi,-104.05188833410045+50.49786204865667*myi,1.1819905216377196+0.04939538377943409*myi,1.2862158889290662+0.05828166390920231*myi,1.4026070942497175+0.07036661083132689*myi,1.5352122962459172+0.08894739447911526*myi,1.6989523647478273+0.12614727927902458*myi,1.9840569286309702+0.24579901632353462*myi,3.261002152651808+1.0250888474040423*myi,-4.26390719251591+23.6118289299455*myi,-126.39611641000205+118.42315822895064*myi,1.0535210678293563+0.02860780970857979*myi,1.1438979369713707+0.03272638907772141*myi,1.2428565777656448+0.03808303670716662*myi,1.3535253013380895+0.0464472277136303*myi,1.4911631694170246+0.06563441209003962*myi,1.7522156544636007+0.13951707596756258*myi,2.9540492713659+0.6281702497850205*myi,21.368648028892117+9.974068255219574*myi,-120.3883010017376+223.01778101651865*myi};
                //const complex<double> f27cPart5_ref[45] = {-0.003004489806867481-0.006661534226132572*myi,-0.0023390220891393075-0.004893423272550898*myi,-0.000652217418110258-0.0012967702595420949*myi,0.0025725370205518243+0.00491432577743658*myi,0.005294815496607197+0.009929576117778307*myi,-0.03430377928679491-0.06806791334118106*myi,0.9385347581147764-0.2931890602274827*myi,3.992824899864368+0.22975757352775458*myi,38.12592213240609+9.13510614316829*myi,-0.006361033930615558-0.008294396911419852*myi,-0.004817359484319448-0.006016354286199209*myi,-0.0013005788839494156-0.0015642207662783752*myi,0.004914793880065687+0.005739576789791866*myi,0.009418680574965302+0.010840423794400669*myi,-0.04903457539611392-0.057730087526890475*myi,1.3325772786201857-2.1583815915433924*myi,7.314319713772142-2.7700415439408124*myi,72.96689739690243-8.403208059166127*myi,-0.009644710394995358-0.008536541613915486*myi,-0.007194348762198333-0.006130138026190063*myi,-0.0019051604912431598-0.001570622405509906*myi,0.00700645608380671+0.005629447565245514*myi,0.012836258606638049+0.010175142903046925*myi,-0.060148303916443574-0.04825942064202818*myi,-1.3079803454568526-1.1685813178142601*myi,9.64544417061065-9.44395401177403*myi,106.72432446293196-48.8228171544459*myi,-0.0124125236173593-0.0077295796511715935*myi,-0.009166675424163627-0.005504547845683754*myi,-0.002395023339938809-0.0013937483421198845*myi,0.0086388467457177+0.004905751030093261*myi,0.015338266720743798+0.008592990421399683*myi,-0.06746078299490288-0.038054453883135414*myi,-1.1400578084832587-0.6828110514078911*myi,7.087278246023032-23.342544161151466*myi,129.18179821147308-117.20475547152479*myi,-0.014439208077999567-0.006234794446172911*myi,-0.010590049270035064-0.0044084783454361965*myi,-0.002739892102112729-0.001105247396248551*myi,0.009740452703954792+0.0038338682146086224*myi,0.016898719187060502+0.0065573067533285755*myi,-0.07121205492377843-0.027730377890522007*myi,-1.0746424213702814-0.4364572748443377*myi,-19.47535501329229-9.704832966499929*myi,123.17198808433969-222.36548062394357*myi};

                // The computation took 42.7845s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f29c_ref[45] = {4.513856529852124+0.0207355852668627*myi,5.361223602411098+0.046867419372780716*myi,6.624108607271655+0.10225601541733553*myi,8.65620349138604+0.23447062307073452*myi,12.433907173691708+0.6243478653382832*myi,22.821909202485084+2.567179581454365*myi,10.692084535966496+33.60298442326314*myi,-2.8798399539731907+26.463237013362225*myi,-7.824065464593247+21.343149376344343*myi,4.0358639153977585-0.01672342427738016*myi,4.704428485527288-0.011223111902779692*myi,5.677680935841327+0.0045368523830759955*myi,7.181239815332177+0.048603859585540476*myi,9.762725143675464+0.18599482897810304*myi,15.33406642968113+0.7673801354773317*myi,29.98647118915443+28.318563553995926*myi,3.1848420350278523+28.184157826656254*myi,-4.593443179030643+23.166621144288627*myi,3.6495067319840047-0.029840490762190086*myi,4.181776694049864-0.03333773896234149*myi,4.942720134717311-0.0352004613257364*myi,6.081961266976778-0.03016274884331871*myi,7.929399611129133+0.0019154474534452959*myi,11.429867994081569+0.16184551665261893*myi,21.880073581287125+1.51626737880229*myi,11.389018404101098+28.215748987292642*myi,-0.5552453106487576+24.507107317068886*myi,3.337499192173418-0.02912944629051495*myi,3.7645367447525793-0.03510936110315299*myi,4.366798023150222-0.04261492246199339*myi,5.2465829209420045-0.05131691634560376*myi,6.612458463566568-0.057668184411678425*myi,8.985004117418619-0.03886656472050731*myi,14.315559518816258+0.2047904690843776*myi,23.63360332122115+24.05165030208523*myi,4.454180994470647+25.124699774631836*myi,3.0857372777635668-0.021835153585378464*myi,3.430723648432444-0.02704941225633206*myi,3.9127406310524773-0.0342688089151153*myi,4.603748413145579-0.0445117754490898*myi,5.640933373917424-0.059131123402437424*myi,7.331718576160419-0.07784223163139359*myi,10.596647403375428-0.0739379390605599*myi,21.682218300103465+0.7364793070766922*myi,10.808478393410638+24.52304908051292*myi};

                //const complex<double> f29c_refIR[45] = {4.486635304162046+0.07815461627921462*myi,5.322292871368917+0.1249887025852274*myi,6.566161129607615+0.21344470463344928*myi,8.565117263776619+0.40242128879807526*myi,12.279279531544942+0.8996836028789141*myi,5.346336395627204-12.205789573888561*myi,10.017948057044876+33.60298442577352*myi,-5.057475499667728+26.46323702091607*myi,-24.31973904433188+21.34314942219406*myi,3.968582398235739+0.1124693954144384*myi,4.6100463613626355+0.16454977520347494*myi,5.53954142038039+0.25471140293988104*myi,6.9672451639265836+0.426492857192057*myi,9.403952181482522+0.8055002379724616*myi,-5.641369071204429-12.579633007658842*myi,2.43120503033608+13.39193406624535*myi,-1.7419898591264074+28.18415783709526*myi,-41.763012566128154+23.16662119790385*myi,3.524531804265531+0.19983563305255003*myi,4.00795249169502+0.2791473935567415*myi,4.6902430488161295+0.40955429505322943*myi,5.693481318447288+0.6416399133113395*myi,7.281926996241506+1.103258396347402*myi,-11.484156676966983-10.021725367767083*myi,-8.151959405894758-7.31114113194571*myi,2.6060711110784114+28.215748999998443*myi,-66.6827498500948+24.50710736829382*myi,3.137197734813837+0.3297394970906848*myi,3.487279779140052+0.4531486583478544*myi,3.965837834165548+0.6523143842206315*myi,4.632040801960965+0.9983747430261678*myi,5.591731863335708+1.6631801728278235*myi,-14.699145832694372-5.899045473300022*myi,-16.80412634451136-0.6303556812194289*myi,-21.144529191452236+51.6955108527766*myi,-98.91529804231605+25.124699813309032*myi,2.7924761703726366-0.5386064312042704*myi,3.0260432327391884-0.7301409591133189*myi,3.3291518038827292-1.0349670089104186*myi,3.7115672467556706-1.556067762520469*myi,4.162398449942714-2.537152753950601*myi,-16.192474053222252-9.933630427066513*myi,-20.651617231195942-11.956102449889388*myi,-24.704351778323606-11.87391384604665*myi,-138.08701453789277-461.03524371700263*myi};
                //p123456 {22.86223497845979-0.9690965469205165*myi,22.91973450794322-0.8799307489864295*myi,23.0180182941976-0.7324534705405352*myi,23.026862633593773-0.45559793299107154*myi,19.53254990111856+0.18736745111935107*myi,8.304192315594802-7.562748033484111*myi,14.992925178282443+24.61152017833385*myi,-5.006138483559135+9.710215415013547*myi,-24.034525564428602-51.237820301629185*myi,19.647249803364016-1.4897168631685966*myi,19.515213279191563-1.345169817985463*myi,19.26698630731818-1.1246339273052872*myi,18.526361964367144-0.7565051221963908*myi,12.102522173591668-0.05025927982452459*myi,-3.8058953337727948-5.689025661297355*myi,0.7696759564689685+3.3788964642030423*myi,-7.96285518124897+7.113948519164169*myi,-56.87383862264505-83.5369057155415*myi,17.218781818227587-1.9663040243562169*myi,16.881487556514607-1.7127383195184895*myi,16.299733693637666-1.334900163078261*myi,14.938839987002757-0.7275641121609072*myi,6.667797791435131+0.3614666026232804*myi,-11.512357329378803-1.7485235764543356*myi,-14.317991812304598-10.885812602449572*myi,-18.010319766598993+7.1139382534094135*myi,-142.70204704106072-102.89799780870622*myi,15.10069032474283-2.3954274109043574*myi,14.550108352252963-1.9681231564873196*myi,13.647035345810705-1.3352150310438966*myi,11.762683674851184-0.3279400252245147*myi,2.5159396351875407+1.4457254045911676*myi,-17.393107801470226+3.7460845466210166*myi,-27.18547414992597+0.38394868093897433*myi,-69.20862436287317+41.42130959539741*myi,-299.5560631206475-90.70471087764548*myi,13.04718701412062-3.790436246644784*myi,12.273038703068169-3.4720689861910548*myi,11.05145972353999-3.0461447039089222*myi,8.709945336765735-2.448563088400756*myi,-0.7778398834669429-1.5480425895969743*myi,-22.45869412126962+1.7510009551461425*myi,-36.90277770675819-3.7435979428413253*myi,-80.96323573755699+21.800112358262037*myi,-555.7959978752292-491.3163304135533*myi};
                //p12345 {12.780258413275911-1.0656485229063746*myi,13.270464197484271-0.9997519617368024*myi,14.065139093724552-0.8800891807694698*myi,15.464011604687489-0.625689873311132*myi,18.41234910756188+0.07958932547053543*myi,12.08796901356487-9.065730388239087*myi,10.210451058340983+37.12152853533655*myi,-22.620884325451367+36.296310573880554*myi,-215.1961849350477+58.37796126536*myi,12.42978658273514-1.6409323086583556*myi,12.67684688540669-1.5313203553256447*myi,13.09126264308691-1.3510803389311477*myi,13.833019552993381-1.010453217023372*myi,15.475152817292322-0.18295140273111826*myi,1.2492545745900936-7.073764701598772*myi,28.26126294278371+35.715581214264894*myi,-31.01090210438229+55.380404032113205*myi,-384.9607428995823+152.8934064743228*myi,11.921351050018817-2.164845163232538*myi,11.932350714315636-1.955646062962507*myi,11.992859315873153-1.627427908144909*myi,12.164986950287608-1.0482407939018128*myi,12.86765587055847+0.22479914682083865*myi,-5.441956014841164-2.1745693224772866*myi,11.430922847254877+9.64246767692358*myi,-34.077838110349504+83.43784818780854*myi,-573.4707897254362+318.04146958249885*myi,11.23006845246004-2.6318148925530243*myi,10.998331965292977-2.2559049709709655*myi,10.703342696403379-1.6789347549629328*myi,10.326003688030635-0.6975384642756333*myi,10.231074556435411+1.3175421725439513*myi,-10.64593595640873+4.336548324328823*myi,-0.7971882144059137+23.092317202998498*myi,101.34651278253745+204.36163835356373*myi,-756.9998767922976+572.5394306690122*myi,10.295077578366943-4.0546112889505395*myi,9.802942181925848-3.7924921154362567*myi,9.13071492478957-3.4265458344747515*myi,8.181517589555481-2.8520621646451136*myi,7.316260962749212-2.0981027379165917*myi,-15.442762471321615+3.093421067804787*myi,-10.167528118691042+18.658579938757104*myi,66.24350615464547+71.9926410854601*myi,-895.5492075060881+464.0286503580345*myi};
                //p1234 {3.8963911030771814+3.629653616011508*myi,4.657428515378158+3.1441746924284626*myi,6.023364975218192+2.4988735780160263*myi,8.716894975733258+1.596470812530228*myi,16.006013346590137-0.8121990782117865*myi,-3.897865791787833+0.8332177608876057*myi,10.478224296089268+43.15018914794418*myi,2.2895055523895658+57.459521639229095*myi,5.801645829148861+243.4889290732605*myi,4.079159736665726+3.424208047025623*myi,4.570669827952624+2.96390692790198*myi,5.560172992081465+2.301451799077913*myi,7.698829653491556+1.2019999712366471*myi,14.342658241159773-2.497681369274605*myi,-13.534058912597224+6.527356356043842*myi,-6.590917440384033+21.20702382147127*myi,13.18324779923717+78.8732254380176*myi,43.049909945964444+391.2231470826138*myi,4.2322126486394245+3.2700253341326446*myi,4.462677036997268+2.906763626674245*myi,5.081156809087441+2.334412076511092*myi,6.667581107411153+1.2383193758922633*myi,12.617776731634844-3.305939734429227*myi,-18.540642131792712+14.164447532272204*myi,-9.02859730690688+35.30089779796338*myi,22.597957252845163+101.84277492884254*myi,83.41320930000096+541.9726774288522*myi,4.343258406057589+3.1018481835884772*myi,4.303376051559602+2.9171494493127104*myi,4.527083949679025+2.559555043398824*myi,5.504464877862258+1.6811876989709083*myi,10.547325920715618-3.1700144025411228*myi,-21.592236384226755+22.632968260579702*myi,-12.806957229904569+48.13829396413974*myi,41.548713930721654+130.69592481152068*myi,114.73879310488371+707.1417343883111*myi,4.357087236472158+1.9664676568223756*myi,4.0256073798850815+1.736019074087742*myi,3.8116378089156466+1.2278557858164858*myi,4.087374497485923-0.061485354631134075*myi,7.932704418323864-6.6959535798200625*myi,-23.807219140551638+23.467004467990204*myi,-15.932641129935076+46.1444141419873*myi,38.393170799545004+160.88860292941493*myi,122.84412467991999+489.70258427289684*myi};
                //p123 {11.60249925076814+22.49251333139355*myi,12.229190148154188+21.221854605321127*myi,13.171678314733816+19.515305908668335*myi,14.374425615275346+16.916954344698045*myi,11.250461901181176+9.329264506668874*myi,28.951720474299297+24.369117289942995*myi,37.681675679683465+64.96661275841669*myi,45.31822026652157+127.53289034605343*myi,169.85192223692667+815.5196641990672*myi,12.006661806961443+19.715882071747114*myi,12.141377391335308+18.875062900714934*myi,12.319927924801526+17.716827984596012*myi,12.031126631872732+15.724944045681129*myi,2.8355151508262995+7.478096572118091*myi,25.912908323773383+30.701891802818785*myi,-74.74539903113637+34.4017724852197*myi,76.50881510751032+154.77792749534382*myi,545.4720925987799+1141.7226005971975*myi,12.394963021571456+17.37802640435296*myi,12.200471919342649+16.89192318576728*myi,11.840681901882384+16.181937206335633*myi,10.397282865471114+14.69048486257443*myi,-4.3269654617221756+5.85411725018454*myi,28.575966352648404+38.08098191103398*myi,-9.27673584681501+64.97114980974233*myi,74.85734426930532+167.4510399520234*myi,956.1488848789477+1223.3024900693656*myi,12.764838520103662+15.001823122919877*myi,12.30953694514726+14.810601940262686*myi,11.497937038924489+14.466575050989789*myi,9.008502629521452+13.37406100871143*myi,-11.162955672579828+4.1037746322097535*myi,34.51883391316489+45.00626456423277*myi,-11.07702136303908+69.01289138524048*myi,-367.37659220394977+87.0417423840185*myi,1225.587211646939+1061.5982658481673*myi,12.96692983255214+11.443330692057717*myi,12.249179078529982+11.18507977330875*myi,10.966077172925695+10.637900230799058*myi,7.363091504943936+9.004129900681885*myi,-18.51047774120267-2.5208369297808604*myi,42.30971372259628+42.86945964604745*myi,-7.889398844726132+57.89974154050044*myi,-13.784918667365698+207.0701890577575*myi,1083.3621772495328+360.10775310149495*myi};
                //p12 {5.642210326741532-7.957744165379741*myi,7.342662415962188-6.5417427160629416*myi,9.54590817818044-4.454245494943422*myi,12.316154009847843-0.8232804317329743*myi,11.142225121622067+7.985355571537664*myi,22.370552884736096+14.511917462370468*myi,0.6845115164848923+76.76620405052827*myi,-32.19295738442849+109.92279574189791*myi,-148.79396641051537+487.5631385628914*myi,3.904092487574827-5.737882971551086*myi,5.146223944359999-3.6838755529979323*myi,6.692722991311534-0.6869792795477391*myi,8.265882733928397+4.350165112727104*myi,2.0573888495442025+16.001766586174007*myi,18.254840671638625+19.45233603636931*myi,-61.295113096665546+77.75157852338589*myi,-32.77825717417995+213.4261609005751*myi,-139.37809910488687+990.0995431585682*myi,2.690693397455201-3.724113508886974*myi,3.6194046854238526-1.0279330993255464*myi,4.707161393107635+2.887911771499031*myi,5.377488613643116+9.374835070183645*myi,-5.3190613214584594+24.291118474307552*myi,19.295972516434073+26.88694042789172*myi,-15.350594230048184+89.53396530466603*myi,-8.781847979709873+346.0061295877486*myi,-34.78622869841092+1624.2265273436187*myi,1.8557709483701625-1.9202562894552955*myi,2.546477133183818+1.431027348311264*myi,3.2676988165026692+6.285454428666819*myi,3.148366204044153+14.275103138318714*myi,-11.892543005938535+32.87531591850955*myi,23.71599999057633+34.8072437852193*myi,-14.46852177371782+101.68190102132706*myi,-232.88746739541878+361.03402508727623*myi,207.9565544432505+2420.5252784902405*myi,1.300429754339185-1.2496891116835607*myi,1.7889937910243152+2.4656054035350286*myi,2.1731343936644407+7.789389074501165*myi,1.2670623139288593+16.49188449825077*myi,-18.213843144651136+37.196284873793715*myi,30.774172861779686+34.45849107150525*myi,-8.170317898304612+101.01986296834343*myi,-7.817907551616915+379.19563178250974*myi,701.6995181581191+2994.3420512340003*myi};
                //p1 {31.80682696370689+26.25559864772615*myi,31.199998198757964+24.520084027885506*myi,30.103681620293525+22.183903339300713*myi,27.119808993924444+18.65324540100092*myi,6.7699665856549+9.707915809536106*myi,92.65503547087714+17.323387359737612*myi,76.11877975863513+27.461413022114865*myi,56.567574099847725+21.754495023458823*myi,-110.09863083563792-102.22263929721953*myi,26.80948229280643+22.855124452145315*myi,25.516119632603957+21.4020075498637*myi,23.261133410192997+19.396105965661466*myi,17.743244517313634+16.14629340072853*myi,-14.629534797723105+5.962026201053912*myi,103.09896368100445+19.230242213687493*myi,89.17042526537413+33.76812930095911*myi,56.11853759634382+35.886087253741735*myi,-175.67903756602539-82.1387578396778*myi,23.578057406039292+20.653703952474874*myi,21.673103492634514+19.53345543180672*myi,18.338527255880155+17.94750621745908*myi,10.355323561865777+15.163267206476606*myi,-34.051425772767594+4.380611537936439*myi,116.84485712052863+23.026676863141883*myi,93.45947598182096-0.8527334141868942*myi,67.17200162135038+59.125023174922724*myi,-191.96423822376198+22.01895349356779*myi,21.636789426791193+19.134123344805943*myi,19.197280045320817+18.420043167123076*myi,14.874334041838337+17.37774600079454*myi,4.524233545680898+15.300616272626714*myi,-51.93047188321723+4.692707043657641*myi,133.5991703564328+28.659130989955756*myi,87.66885035855178+8.551675173725375*myi,95.15990835676558+105.43982224474684*myi,-142.61471076810847+248.34802168357655*myi,21.009705272576955+17.50974798999167*myi,18.152383167839083+17.11748937683321*myi,12.99333700163811+16.49193446638738*myi,0.4699936809844303+14.938087673795387*myi,-67.96269928290268+4.0948464248473515*myi,154.4081135131018+31.8396171582984*myi,93.36452586102264+14.105651229205762*myi,174.34533159376045-0.9415992589718485*myi,16.69921940335583+414.49242718774144*myi};

                // The computation took 5.55759s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                // feynepsilonhat = 1e-10
                const complex<double> f29e_ref[45] = {2.3021828027409255 - 6.463426460712185e-10 * myi, 2.385948579526878 - 1.044983460873894e-9 * myi, 2.700100154127618 - 1.5445331680297159e-9 * myi, 3.6163362509571346 - 1.932085602618372e-9 * myi, 6.666877489981057 + 2.8917135352912737e-10 * myi, 28.623209566833367 + 9.837709313842424e-8 * myi, -48.40967194198186 - 5.577487933474039 * myi, -16.874156506724486 - 14.088669006050232 * myi, -8.120489514625849 - 13.065461479444517 * myi, 2.3891251350058544 - 1.0545575523934758e-10 * myi, 2.53201813513229 - 2.763216322421158e-10 * myi, 2.905754685469725 - 4.0957903735261425e-10 * myi, 3.8132032921355905 - 2.3579538321882865e-10 * myi, 6.262937168090792 + 1.854425946135052e-9 * myi, 16.09708865543818 + 2.5199682340826257e-8 * myi, -139.6018251283025 + 89.57165539021763 * myi, -34.10106085600972 - 12.77883576501469 * myi, -16.18476485749127 - 15.329293002930044 * myi, 2.360596786243271 + 2.0758150753863447e-10 * myi, 2.5208807225145855 + 1.4876189169399368e-10 * myi, 2.8920338899305498 + 1.6927081958328927e-10 * myi, 3.710589948855498 + 4.959286314942801e-10 * myi, 5.655080738092669 + 2.130152054746759e-9 * myi, 11.553725232419755 + 1.2162026052919828e-8 * myi, 58.30623682360957 + 3.0637617953743757e-7 * myi,-62.76950940050142 + 0.031852335768391526 * myi, -27.510523556251457 - 15.546163093825761 * myi, 2.2611611038878188 + 3.9498049275721314e-10 * myi, 2.417885207731062 + 3.929780945099992e-10 * myi, 2.7603235654499256 + 4.773212936015625e-10 * myi, 3.4718374685672275 + 8.230784942497849e-10 * myi, 5.022765191422876 + 2.0671784284331807e-9 * myi, 8.99999956749037 + 7.480778663193632e-9 * myi, 25.235965138100266 + 5.594193908109446e-8 * myi, -129.21960318321723 + 67.6483365255224 * myi, -43.80351847021929 - 11.716589533222155 * myi, 2.1167522450187013 + 5.073221842621933e-10 * myi, 2.2593251623889987 + 5.336877606509915e-10 * myi, 2.5628117869741036 + 6.408615860209466e-10 * myi, 3.1698959791101298 + 9.60874046995741e-10 * myi, 4.4158702116722175 + 1.9111201510213505e-9 * myi, 7.274234695054613 + 5.2121578164587845e-9 * myi, 15.966659039855655 + 2.29688197350697e-8 * myi, 104.86751778726 + 8.100933825971879e-7 * myi, -69.40585654227208 + 1.840951225135683 * myi};

                // feynepsilonhat = 1e-14
                //const complex<double> f29ev2_ref[45] = {2.302182802740934 - 6.583622536027178e-14*myi,2.3859485795268744 - 1.0219602941674566e-13*myi, 2.700100154127613 - 1.5587531265737198e-13*myi,3.6163362509571346 - 1.8740564655672642e-13*myi, 6.66687748998105 + 3.019806626980426e-14*myi,28.623209566833353 + 9.833911462919787e-12*myi, -48.40967203064752 - 5.577488119383567*myi,-16.87415650098007 - 14.088669061363333*myi, -8.120489503002077 - 13.065461506979855*myi,2.38912513500586 - 1.2323475573339238e-14*myi, 2.532018135132292 - 2.7533531010703882e-14*myi,2.90575468546973 - 4.796163466380676e-14*myi, 3.8132032921355923 - 2.7533531010703882e-14*myi,6.2629371680907635 + 1.3855583347321954e-13*myi, 16.09708865543817 + 2.5579538487363607e-12*myi,-139.6018264704346 + 89.57165452714135*myi, -34.10106087706429 - 12.778835852309772*myi,-16.18476485202037 - 15.329293041771372*myi, 2.360596786243269 + 2.7977620220553945e-14*myi,2.5208807225145855 + 1.509903313490213e-14*myi, 2.892033889930551 + 1.0658141036401503e-14*myi,3.7105899488554925 + 5.1514348342607263e-14*myi, 5.65508073809269 + 1.5987211554602254e-13*myi,11.55372523241972 + 1.2647660696529783e-12*myi, 58.30623682360959 + 3.065281362069072e-11*myi,-62.76950950082173 + 0.031852180036352706*myi, -27.510523562152954 - 15.546163148512225*myi,2.2611611038878183 + 4.75175454539567e-14*myi, 2.417885207731071 + 4.3520742565306136e-14*myi,2.760323565449924 + 3.730349362740526e-14*myi, 3.4718374685672426 + 6.572520305780927e-14*myi,5.022765191422869 + 2.5934809855243657e-13*myi, 8.999999567490438 + 7.744915819785092e-13*myi,25.235965138100273 + 5.5990767577895895e-12*myi, -129.21960387622306 + 67.64833601689656*myi,-43.80351849993297 - 11.716589613824716*myi, 2.1167522450187004 + 5.773159728050814e-14*myi,2.2593251623889863 + 6.128431095930864e-14*myi, 2.5628117869741107 + 7.016609515630989e-14*myi,3.169895979110128 + 1.2079226507921703e-13*myi, 4.415870211672161 + 2.327027459614328e-13*myi,7.274234695054517 + 4.831690603168681e-13*myi, 15.966659039855637 + 2.3092638912203256e-12*myi,104.86751778725996 + 8.100187187665142e-11*myi, -69.40585663652078 + 1.840951089440921*myi};

                for (unsigned int i = 0; i < 45; i++)
                {
                    const double z = z_s_list[i][0];
                    const complex<double> s = z_s_list[i][1];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ z, /*feynepsilonhat*/ 1e-10};

                    const complex<double> f27c_res = agv_2019a::f27c(testclp);
                    const complex<double> f29c_res = agv_2019a::f29c(testclp);
                    const complex<double> f29e_res = agv_2019a::f29e(testclp);

                    TEST_CHECK_NEARLY_EQUAL(f27c_ref[i].real(), f27c_res.real(), 5*eps);
                    TEST_CHECK_NEARLY_EQUAL(f27c_ref[i].imag(), f27c_res.imag(), 5*eps);

                    TEST_CHECK_NEARLY_EQUAL(f29c_ref[i].real(), f29c_res.real(), 150*eps);
                    TEST_CHECK_NEARLY_EQUAL(f29c_ref[i].imag(), f29c_res.imag(), 150*eps);

                    TEST_CHECK_NEARLY_EQUAL(f29e_ref[i].real(), f29e_res.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f29e_ref[i].imag(), f29e_res.imag(), eps);
                }
            }
        }
} two_loop_test ;
