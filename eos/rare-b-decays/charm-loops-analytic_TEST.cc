/* vim: set sw=4 sts=4 et foldmethod=syntax : */

/*
 * Copyright (c) 2022 Viktor Kuschke
 *
 * This file is part of the EOS project. EOS is free software;
 * you can redistribute it and/or modify it under the terms of the GNU General
 * Public License version 2, as published by the Free Software Foundation.
 *
 * EOS is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
 * details.
 *
 * You should have received a copy of the GNU General Public License along with
 * this program; if not, write to the Free Software Foundation, Inc., 59 Temple
 * Place, Suite 330, Boston, MA  02111-1307  USA
 */

#include <test/test.hh>
#include <eos/rare-b-decays/charm-loops.hh>

#include <cmath>

using namespace test;
using namespace eos;
using namespace agv_2019a;

class LoopParameterTest :
    public TestCase
{
    public:
        LoopParameterTest() :
            TestCase("loop_parameter_test")
        {
        }

        virtual void run() const
        {
            {
                static const double eps = 1e-12;
                const complex<double> myi(0.0, 1.0);
                agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ -4.0, /*z =*/ 0.15, /*feynepsilonhat*/ 1e-10};

                /* Check, that the square root in C++ of complex arguments is handled correctly */

                static const complex<double> m1(-1.0, 0.0);
                TEST_CHECK_NEARLY_EQUAL(0.0, std::sqrt(m1).real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.0, std::sqrt(m1).imag(), eps);

                /* Comparison with Mathematica results */

                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_a.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.7745966689726898,     testclp.x_b.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_c.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.7745966689726898,     testclp.x_d.real(), eps);
                TEST_CHECK_NEARLY_EQUAL(1.5811388300841895,     testclp.x_e.real(), eps);

                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_a.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.6324555318142068,     testclp.x_b.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_c.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(0.6324555318142068,     testclp.x_d.imag(), eps);
                TEST_CHECK_NEARLY_EQUAL(-6.719840027857805e-10, testclp.x_e.imag(), eps);

                /* Check, that the logarithm of complex numbers with negative real part is consistent with Mathematica */

                const double s_list[9] = {-1.0, -7.0 / 9.0, -5.0 / 9.0, -1.0 / 3.0, -1.0 / 9.0, 1.0 / 9.0, 1.0 / 3.0, 5.0 / 9.0, 7.0 / 9.0};
                const complex<double> lnms_ref[9] = {5.0000000000000005e-21 + 1.e-10 * myi,-0.25131442828090605 + 1.e-10 * myi,-0.587786664902119 + 1.e-10 * myi,-1.0986122886681096 + 1.0000000000000002e-10 * myi,-2.197224577336219 + 1.e-10 * myi,-2.19722457733622 - 3.141592653489793 * myi,-1.09861228866811 - 3.141592653489793 * myi,-0.5877866649021192 - 3.141592653489793 * myi,-0.2513144282809062 - 3.141592653489793 * myi};

                for (unsigned int i = 0; i < 9; i++)
                {
                    const double s = s_list[i];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ 0.15, /*feynepsilonhat*/ 1e-10};
                    const complex<double> lnms = std::log(-testclp.s_eps);

                    TEST_CHECK_NEARLY_EQUAL(lnms_ref[i].real(), lnms.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(lnms_ref[i].imag(), lnms.imag(), eps);
                }
            }
        }
} loop_parameter_test ;

class TwoLoopTest :
    public TestCase
{
    public:
        TwoLoopTest() :
            TestCase("two_loop_test")
        {
        }

        virtual void run() const
        {
            static double eps = 1e-12;
            const complex<double> myi(0.0, 1.0);
            const double z_s_list[45][2] = {{0.05, -1.0},     {0.05, -7.0 / 9.0},    {0.05, -5.0 / 9.0},    {0.05, -1.0 / 3.0},    {0.05, -1.0 / 9.0},  {0.05, 1.0 / 9.0},  {0.05, 1.0 / 3.0},  {0.05, 5.0 / 9.0},  {0.05, 7.0 / 9.0},
                                            {0.075, -1.0},    {0.075, -7.0 / 9.0},   {0.075, -5.0 / 9.0},   {0.075, -1.0 / 3.0},   {0.075, -1.0 / 9.0}, {0.075, 1.0 / 9.0}, {0.075, 1.0 / 3.0}, {0.075, 5.0 / 9.0}, {0.075, 7.0 / 9.0},
                                            {0.1, -1.0},      {0.1, -7.0 / 9.0},     {0.1, -5.0 / 9.0},     {0.1, -1.0 / 3.0},     {0.1, -1.0 / 9.0},   {0.1, 1.0 / 9.0},   {0.1, 1.0 / 3.0},   {0.1, 5.0 / 9.0},   {0.1, 7.0 / 9.0},
                                            {0.125, -1.0},    {0.125, -7.0 / 9.0},   {0.125, -5.0 / 9.0},   {0.125, -1.0 / 3.0},   {0.125, -1.0 / 9.0}, {0.125, 1.0 / 9.0}, {0.125, 1.0 / 3.0}, {0.125, 5.0 / 9.0}, {0.125, 7.0 / 9.0},
                                            {0.15, -1.0},     {0.15, -7.0 / 9.0},    {0.15, -5.0 / 9.0},    {0.15, -1.0 / 3.0},    {0.15, -1.0 / 9.0},  {0.15, 1.0 / 9.0},  {0.15, 1.0 / 3.0},  {0.15, 5.0 / 9.0},  {0.15, 7.0 / 9.0}};

            // Counterterms

            {
                // The computation took 1.090361s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f17ct_ref[45] = {0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi, 0.007508380484939292 + 6.873191015900809e-13 * myi, 0.005952604401909534 + 5.547258909565289e-13 * myi, 0.004336911891155662 + 4.1182723464905446e-13 * myi, 0.002656161338996113 + 2.572749847338921e-13 * myi, 0.0009044920478106094 + 8.946448429403098e-14 * myi, -0.0009248201293365621 - 9.353157026853862e-14 * myi, -0.002839546035419166 - 2.940497627051733e-13 * myi, -0.004848738820221368 - 5.14954318682398e-13 * myi, -0.006963041259226838 - 7.598075046419174e-13 * myi};

                // The computation took 5.23546s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f19ct_ref[45] = {-2.7747020877105797+5.626346304045955e-9*myi,-3.678411078930253+6.551498509238362e-9*myi,-5.189029077982212+7.622673015584751e-9*myi,-8.082810669902756+8.358442082775868e-9*myi,-15.295431631415227+4.10848830837457e-9*myi,-54.58909756932087-0.2962036019425178*myi,70.55799350353001-17.653390450324757*myi,30.565735956813924+5.7665720781398235*myi,18.123518226961437+8.16568053415471*myi,-3.893962954910876+3.6667442484171744e-9*myi,-4.9435312452224025+4.047484854303513e-9*myi,-6.590976326253326+4.3029628743453725e-9*myi,-9.469670526543581+3.875115198659835e-9*myi,-15.549077574087107-2.327794826955606e-10*myi,-34.693573875853275-0.29620348722185535*myi,167.92305609469395-169.05788651872777*myi,52.46869793945905-5.200967465309851*myi,29.684631469279182+5.682142901544971*myi,-4.6121577307674215+2.4686952677874505e-9*myi,-5.708816327234217+2.5808340482679426e-9*myi,-7.354933349386755+2.490392924813179e-9*myi,-10.05051056855254+1.734163658380889e-9*myi,-15.153979279758971-1.5672712814544838e-9*myi,-27.418279308218146-0.2962034663408389*myi,-106.01160307383219-0.18257783824640594*myi,84.59645934900874-33.95940219738226*myi,43.98892291368844-0.5735255289875738*myi,-5.072667438223817+1.6824488080230685e-9*myi,-6.166265303521357+1.655473734962947e-9*myi,-7.751673931711565+1.4166070071917854e-9*myi,-10.22260815512277+6.081296126569895e-10*myi,-14.548968500514661-1.9781302920086277e-9*myi,-23.33010199275789-0.2962034587959605*myi,-53.38314519171202-0.18257745555047408*myi,153.5213258190528-140.2100221981614*myi,62.635938975007846-13.392627642880836*myi,-5.357791346984698+1.1439296343338859e-9*myi,-6.42217138552391+1.0446350252241993e-9*myi,-7.922209335544608+7.481806136477017e-10*myi,-10.170139590163245-1.6911948663200337e-11*myi,-13.881352337142118-2.052076503827342e-9*myi,-20.571120817214762-0.29620345513394997*myi,-37.880978841112146-0.18257740232203398*myi,-180.21214469438945-0.1297454551302265*myi,89.84030337463037-40.709145314441294*myi};

                // The computation took 1.08506s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f27ct_ref[45] = {-0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi, -0.04505028290963531 - 4.123914609540503e-12 * myi, -0.03571562641145776 - 3.3283553457391752e-12 * myi, -0.026021471346933556 - 2.470963407894314e-12 * myi, -0.015936968033976706 - 1.543649908403359e-12 * myi, -0.005426952286864184 - 5.36786905764194e-13 * myi, 0.005548920776019206 + 5.611360414563721e-13 * myi, 0.017037276212515384 + 1.7643509111750194e-12 * myi, 0.029092432921328126 + 3.089723044977223e-12 * myi, 0.0417782475553613 + 4.558784583472264e-12 * myi};

                // The computation took 5.27316s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f29ct_ref[45] = {-1.608986716471776+3.934295499979576e-9*myi,-2.3693283777971317+4.271854880838442e-9*myi,-3.7800190331181796+4.402372917703126e-9*myi,-6.599376801954662+3.5067631829492385e-9*myi,-13.404671606463694-3.753818639220557e-9*myi,-50.98081440086062+1.7772205299757942*myi,52.76153897156211-38.65385854966077*myi,34.66130927641784-12.829931777947536*myi,29.017679457734744-5.407202046720414*myi,-2.401870228870557+2.652835236941801e-9*myi,-3.1817692982717034+2.698718235901337e-9*myi,-4.538488326070166+2.4507032774885e-9*myi,-7.036633206233375+1.244260771205401e-9*myi,-12.213990799607984-3.984122385193444e-9*myi,-30.90700561930492+1.7772206377857764*myi,107.16140038893903-148.86783796939537*myi,46.114443570219464-23.70169235520142*myi,35.328110799930535-9.590736456099371*myi,-2.9414233745675844+1.8750311194276108e-9*myi,-3.6918220890152753+1.7933824848964267e-9*myi,-4.938908656081523+1.4262694196122121e-9*myi,-7.0986719328511185+2.821701102354999e-10*myi,-11.102215787231103-3.4649922257079255e-9*myi,-23.22044639006853+1.7772206593931228*myi,-89.78355190008688+1.0954637858202039*myi,62.98816795440386-46.82941116582578*myi,42.92255440219149-16.42890162479344*myi,-3.3211858277453743+1.3656343000405952e-9*myi,-4.021094256914381+1.2293665602458048e-9*myi,-5.1442919083031455+8.41362748745472e-10*myi,-6.997705859671058-1.5657051029408877e-10*myi,-10.142144919941671-2.905822344058433e-9*myi,-18.936989330517427+1.7772206675965885*myi,-45.21119817675006+1.0954640964488*myi,102.8561882200495-124.64515483844737*myi,52.751369875880215-27.83701399063691*myi,-3.5939711464536828+1.0157641805518302e-9*myi,-4.235378448263781+8.599867522896628e-10*myi,-5.23645786793729+4.89817231583082e-10*myi,-6.824324716574154-3.572393189764593e-10*myi,-9.323332766521304-2.4259036057229785e-9*myi,-16.137135778031848+1.777220671669935*myi,-31.4613064877505+1.0954641421398201*myi,-146.15081645857504+0.7784645027656028*myi,67.4668671122318-49.36283092562938*myi};

                for (unsigned int i = 0; i < 45; i++)
                {
                    const double z = z_s_list[i][0];
                    const complex<double> s = z_s_list[i][1];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ z, /*feynepsilonhat*/ 1e-10};

                    const complex<double> f17ct = agv_2019a::f17ctQs(testclp) + agv_2019a::f17ctQc(testclp) + agv_2019a::f17ctQb(testclp);
                    const complex<double> f19ct = agv_2019a::f19ctQs(testclp) + agv_2019a::f19ctQc(testclp) + agv_2019a::f19ctQb(testclp);
                    const complex<double> f27ct = agv_2019a::f27ctQs(testclp) + agv_2019a::f27ctQc(testclp) + agv_2019a::f27ctQb(testclp);
                    const complex<double> f29ct = agv_2019a::f29ctQs(testclp) + agv_2019a::f29ctQc(testclp) + agv_2019a::f29ctQb(testclp);

                    TEST_CHECK_NEARLY_EQUAL(f17ct_ref[i].real(), f17ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f17ct_ref[i].imag(), f17ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f19ct_ref[i].real(), f19ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f19ct_ref[i].imag(), f19ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f27ct_ref[i].real(), f27ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f27ct_ref[i].imag(), f27ct.imag(), eps);

                    TEST_CHECK_NEARLY_EQUAL(f29ct_ref[i].real(), f29ct.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f29ct_ref[i].imag(), f29ct.imag(), eps);
                }
            }

            // Two loop functions

            {
                static double eps = 1e-12;
/*
                // The computation took 19.5591s AbsoluteTiming with the Methematica-Ginac script from [AGV:2019A]
                const complex<double> f27a_ref[45] = {0.22820842548329867+0.03284371205569114*myi,0.24322769157762436+0.038807446284946145*myi,0.26125394694869497+0.047508301945062836*myi,0.28369187897119896+0.061560652401266236*myi,0.31282262823987966+0.08948335331359147*myi,0.30793554542001145+0.15190390991685027*myi,0.2835394815474132+0.17453482839483492*myi,0.2659117064548151+0.18807482777462914*myi,0.25167739857336713+0.19779897979563899*myi,0.1942262099395171+0.015747105165950348*myi,0.20751249514080594+0.01884930884765368*myi,0.22372458623749508+0.02351831767405843*myi,0.24463371479392249+0.03143542261205623*myi,0.274534554628007+0.0487104444737394*myi,0.28542163932296316+0.10497461448205425*myi,0.2675801944480435+0.13175126609782584*myi,0.2534960136717421+0.1482279346961768*myi,0.241627863938783+0.16025051932819934*myi,0.16645325509067144+0.0070655760260136535*myi,0.17797119045536447+0.008554220180702288*myi,0.19206401194042821+0.01085624811041852*myi,0.21046491233817016+0.014932462684399517*myi,0.23802694089995924+0.024626783050882728*myi,0.25871995614499+0.07169968659932635*myi,0.24716924227864856+0.0998914003429483*myi,0.23666032853125607+0.11777793089896793*myi,0.22725464768356218+0.13105242565722863*myi,0.14385120056625744+0.0028418587109217963*myi,0.15383165223752537+0.0034769130379967983*myi,0.16597783790901066+0.004483920247051687*myi,0.18180478887241847+0.006341870696572438*myi,0.205882958222052+0.011154491652198506*myi,0.23162741198184045+0.04861818766051762*myi,0.22551840625100988+0.07638961331501815*myi,0.21826240395351126+0.09461115090738242*myi,0.21116191302573561+0.10838289879031443*myi,0.1253602314267599+0.0009632892835105267*myi,0.13409970793541337+0.0011904116273360188*myi,0.14463317059892322+0.0015593946514974588*myi,0.1582094609654583+0.002268564706348397*myi,0.17872815784755386+0.004277619489111539*myi,0.20604953478302296+0.033090915231659634*myi,0.20431183133982378+0.05927954183803186*myi,0.19983162152652945+0.07710369130760691*myi,0.1947612479177847+0.09084011783500079*myi};

                // The computation took 22.2867s AbsoluteTiming with the Methematica-Ginac script from [AGV:2019A]
                const complex<double> f29a_ref[45] = {-1.327593865389298-0.26354311133041985*myi,-1.4752272048905066-0.31892150923336793*myi,-1.701417762302468-0.4053802100753181*myi,-2.1007213493562373-0.5630064622825302*myi,-3.150248273544651-0.9902966237413686*myi,-0.7597102025321296-4.134375257724479*myi,0.16753628934200737-2.9100769956755577*myi,0.4974848467549766-2.3381370294447197*myi,0.6773412441390434-1.9597798499797952*myi,-1.174311190527999-0.15514452828030834*myi,-1.3103448154388344-0.1897059207632319*myi,-1.5228195635238784-0.24487728930679786*myi,-1.9067438800032237-0.34893822649070927*myi,-2.9484978085140274-0.6491865159295083*myi,-0.8585268855028432-3.8355451575958712*myi,0.09347127701492153-2.6969010669564253*myi,0.4332264060021709-2.1601946401686285*myi,0.6189732755843638-1.8032387227327886*myi,-1.031851997909416-0.08601215472262158*myi,-1.1541823598664762-0.10610702883207601*myi,-1.3485806069093482-0.13881082239841191*myi,-1.707045931604111-0.20240218784562547*myi,-2.708647789225609-0.39708733657481154*myi,-0.8966424700433189-3.5458869195213674*myi,0.05895489858151093-2.4918355485129613*myi,0.4005894972674273-1.9895284697137834*myi,0.5876647077034924-1.6533316758674381*myi,-0.9033591077645449-0.04355378332207671*myi,-1.0118657632051313-0.05415494340115856*myi,-1.1870941854763062-0.07171553361522243*myi,-1.5160352669914974-0.1068565395336103*myi,-2.459127048591247-0.22100616808667084*myi,-0.8860758954385597-3.274680785067058*myi,0.055600033360480694-2.2993133350758126*myi,0.392636146665593-1.8290654279801188*myi,0.5773484745524833-1.5122277422367745*myi,-0.7895963007241877-0.019228145658293005*myi,-0.8852409765960578-0.02408278061223923*myi,-1.042123061348065-0.032260072893188774*myi,-1.3413611068846678-0.04909068922306581*myi,-2.2182923911288244-0.10724895973649762*myi,-0.8371655238898433-3.0282708948147423*myi,0.07680072001682103-2.122363664368087*myi,0.40411706671191006-1.6807994286205883*myi,0.5835471540035471-1.3813992013466887*myi};

                // The computation took 83.3218s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f27b_ref[45] = {0.22116104744579745-5.5334126169981346e-11*myi,0.20735428622243157-5.7376103868023165e-11*myi,0.19305033438721408-5.954226001136931e-11*myi,0.1782084657024352-6.184797118891083e-11*myi,0.16278245487666587-6.430883603414372e-11*myi,0.1467195039633833-6.694622634029201e-11*myi,0.1299588861684262-6.978229105669698e-11*myi,0.11243021094760941-7.285905212484067e-11*myi,0.09405117317643885-7.645439836778678e-11*myi,0.23600156921419213-4.4674319799042905e-11*myi,0.22239592222915672-4.651884433215514e-11*myi,0.20830218848609006-4.847799939255992e-11*myi,0.19368042539307972-5.056499663425029e-11*myi,0.17848529636420096-5.2794324467697606e-11*myi,0.16266501708188308-5.518474566201803e-11*myi,0.14616002416645912-5.775502298632773e-11*myi,0.12890127174735078-6.055067558463634e-11*myi,0.11080802098258857-6.400568963726982e-11*myi,0.24882632335598132-3.7410519126979125e-11*myi,0.23538728178064572-3.912170587483388e-11*myi,0.22146752951941262-4.0941139367589585e-11*myi,0.20702774985262873-4.2879033657072796e-11*myi,0.19202331511608017-4.495293026707259e-11*myi,0.17640324854303957-4.717759516381648e-11*myi,0.1601089124094912-4.9573900540167415e-11*myi,0.14307232922789126-5.2166271302667155e-11*myi,0.12521400279035788-5.5422333389287814e-11*myi,0.2602318289764167-3.200084641719059e-11*myi,0.24693559950846455-3.3614222516575865e-11*myi,0.23316485807265486-3.533040526804143e-11*myi,0.21888080713768954-3.7159830768018765e-11*myi,0.20403940647623764-3.9118042138852616e-11*myi,0.18859034771783278-4.122013841367789e-11*myi,0.17247575836516482-4.348699178535753e-11*myi,0.1556285430290103-4.5986325858393684e-11*myi,0.13797023009533405-4.843059286940843e-11*myi,0.2705632944288101-2.7750690634320563e-11*myi,0.2573922497380883-2.928768338961163e-11*myi,0.24375203037357562-3.092315292718695e-11*myi,0.22960428059676508-3.266831249959523e-11*myi,0.2149054595512967-3.4537039894644295e-11*myi,0.19960582646857494-3.65427688109321e-11*myi,0.18364815797124834-3.871214460104966e-11*myi,0.1669661060679175-4.1026737562788185e-11*myi,0.14948206622557336-4.359890226623975e-11*myi};
                //const complex<double> f27b_ref[45] = {0.22753484243673378-0.001522073905323218*myi,0.214673271531971-0.0018962751666449784*myi,0.20112895315611873-0.0023106869273533115*myi,0.1861532914127709-0.0025684996736222154*myi,0.16748096984537192-0.001775346992997695*myi,0.13739010704943608+0.004334343012465457*myi,0.06388453346910195+0.04109599348454993*myi,-0.23814373465698108+0.3467474447261435*myi,-2.7246370238125124+7.767142744565177*myi,0.2525611258801021-0.0052875191497715615*myi,0.24182532938965895-0.006587453655285547*myi,0.23032156980304003-0.008027075067183798*myi,0.21606760795839786-0.008922688526763697*myi,0.19231672282242165-0.006167362323297331*myi,0.13346515921400526+0.015057036725782513*myi,-0.08139539235025572+0.14276301520840884*myi,-1.319701578610812+1.2045629398308528*myi,-20.493659938459388+26.982209812401152*myi,0.2810297164681277-0.01296127255314409*myi,0.27363530308911527-0.016147796336253177*myi,0.265455179512252-0.01967673402553467*myi,0.25256293264080043-0.02187214739586496*myi,0.22080049482975878-0.0151180282897442*myi,0.11383397926764116+0.036909248580640486*myi,-0.34766828500443925+0.3499543571116208*myi,-3.295155997290518+2.9527398862823233*myi,-54.818040684101845+66.14137337722866*myi,0.31385187942151305-0.026340006192554496*myi,0.3111332811385321-0.03281568641527592*myi,0.30771041485818773-0.039987223037062564*myi,0.2969594127567883-0.04444876041168709*myi,0.254106412953051-0.03072298320288983*myi,0.0777066917842113+0.07500728305169257*myi,-0.7492262740884676+0.7111801653080221*myi,-6.2917918380828795+6.000582641883158*myi,-108.05909133566365+134.41305105219908*myi,0.35158323060248514-0.047755940586644625*myi,0.35495250108466225-0.059496719914594265*myi,0.35782030067058895-0.07249912677106274*myi,0.35008613369228514-0.0805881496996647*myi,0.2929716440894475-0.05570252907551775*myi,0.02442892710878164+0.13599250247727357*myi,-1.29703499024603+1.2894103938123749*myi,-10.412627389450133+10.879400193620004*myi,-182.0085849064057+243.6985641451947*myi};
                //{0.22728141703109928-0.003670920274518069*myi,0.21441095922965459-0.003963839245817807*myi,0.2008842910597306-0.004090248891321369*myi,0.1859778663925052-0.003736102343278286*myi,0.16743738111895723-0.0020382748362680614*myi,0.13727500541322168+0.0037120894417997582*myi,0.060334540238944856+0.024114699900446103*myi,-0.29237160995996764+0.12058034130847595*myi,-4.573442299227189+1.1565680456941294*myi,0.2536646794948773-0.011733030443628445*myi,0.24292672777615712-0.012877049791454792*myi,0.23131017954857006-0.01352476987483675*myi,0.2167484069582592-0.01259101441787841*myi,0.19247886968147973-0.007008510912282773*myi,0.1338747748529222+0.013028021454415506*myi,-0.06933217614931708+0.08630952959121319*myi,-1.1440699150176936+0.4387244875682552*myi,-14.796945149702879+4.247724743293077*myi,0.28455760173735567-0.02671119108370218*myi,0.2771934347971779-0.029707595269749587*myi,0.268688757897406-0.03167250880464989*myi,0.2548227925333296-0.029986570267653334*myi,0.22134832803403678-0.01700781204357954*myi,0.11524772049500853+0.0322703930260092*myi,-0.30494894768792413+0.21839386032712538*myi,-2.653728116244464+1.1322836791461377*myi,-33.247793469062515+11.105928148590863*myi,0.320605941998757-0.050732068594583346*myi,0.3179689327645717-0.05706887620243262*myi,0.313950786419534-0.06164948767318801*myi,0.301346831056015-0.05926806498131382*myi,0.2551785605256245-0.03422068956790841*myi,0.0805037072135194+0.06628410431908338*myi,-0.6634377150075776+0.45911972213027563*myi,-4.976905367632266+2.437986760831892*myi,-62.59276118691457+24.35612127373585*myi,0.3620316616488257-0.08630851329000955*myi,0.36553430772948525-0.09808138204221006*myi,0.36749346415380835-0.10723048870733709*myi,0.3569028559625646-0.10457149912120334*myi,0.29464388073847647-0.061428439302370075*myi,0.02881911827355177+0.12150695365018582*myi,-1.1609762642051855+0.8632572857118892*myi,-8.29103757202271+4.7198016396421*myi,-106.53444895383291+48.428507415408745*myi};
                //{1.5539718205048714-0.23785795466215148*myi,1.5884251615443807-0.2691538289904516*myi,1.6346087170082104-0.3085640795332809*myi,1.6951019847027895-0.35688677517995265*myi,1.7662376468271916-0.4081767308006359*myi,1.8025291300459343-0.41833926012908*myi,1.459696463544085-0.09358216146436157*myi,-2.8285193457392253+3.3713228644013666*myi,-118.33169264408127+87.87479138483754*myi,1.602403293566113-0.33038883308014466*myi,1.6342174849101518-0.3676207008081884*myi,1.6806390792726633-0.41631025423457435*myi,1.7554319269108527-0.48406423949731486*myi,1.897888639416925-0.5905923013548169*myi,2.250550107529916-0.806187406486981*myi,3.528119530907827-1.505334210828801*myi,11.74868459963685-6.219618096255878*myi,186.2092679858695-123.33803583381783*myi,1.6196345495975863-0.41178823826907135*myi,1.6472419219613428-0.4529906746889119*myi,1.6912948883011567-0.5084986405993136*myi,1.7742390297631911-0.5928935005629818*myi,1.96857577553842-0.7528853559580029*myi,2.5604909119265518-1.1808061912694576*myi,5.060548602224818-2.9696995991065416*myi,22.54451295793332-16.504304558039475*myi,405.594979427484-352.83534797851405*myi,1.6087375152613193-0.47706364890450187*myi,1.6307824620424998-0.5203394326292499*myi,1.6702082380224992-0.5800986942722002*myi,1.7559119345677323-0.6773523956150447*myi,1.9848838065853334-0.8842519443342199*myi,2.7471556225020812-1.5092775959799718*myi,6.112299141883354-4.332999908820776*myi,29.92463874885593-26.326763465835448*myi,547.0878124778719-574.5418392506002*myi,1.5720498502009717-0.520454361438192*myi,1.5873903873844728-0.5638136116093282*myi,1.6202532015499023-0.6249867644250253*myi,1.7039180188271863-0.7302563447580548*myi,1.9517302530453802-0.9731805539371475*myi,2.8203997020324736-1.7609859936164756*myi,6.717291506250927-5.461164567113449*myi,34.11322754781906-34.68445570011063*myi,615.1427161530675-765.3699707761673*myi};

                // The computation took 108.757s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f29b_ref[45] = {-0.5199119415599585-1.4654322200158276e-10*myi,-0.5079622656422487-1.4769074851983532e-10*myi,-0.49599108866826214-1.489528500542292e-10*myi,-0.4840162125816292-1.503384083889614e-10*myi,-0.4720598373043323-1.5189627333711542e-10*myi,-0.460149740874094-1.5361578675765486e-10*myi,-0.44832084337332745-1.5553514032262683e-10*myi,-0.4366173073315984-1.5758061522319622e-10*myi,-0.4250954011656063-1.5927525964798406e-10*myi,-0.48529093847569627-1.256079684708311e-10*myi,-0.472775719200496-1.263318338828867e-10*myi,-0.46020878323730496-1.2712941810377743e-10*myi,-0.4476049181150774-1.2803980098397005e-10*myi,-0.43498284742866034-1.290487716687494e-10*myi,-0.4223663122083252-1.3022827261011116e-10*myi,-0.40978550820379667-1.3154366484968705e-10*myi,-0.39727902173666507-1.3297096757014515e-10*myi,-0.3848964761693878-1.3426415534922853e-10*myi,-0.45456645876278046-1.1091660923057134e-10*myi,-0.4415583724370755-1.113260594820531e-10*myi,-0.42847239058854125-1.1179590586607446e-10*myi,-0.4153206959735485-1.1234924102154764e-10*myi,-0.40211900886071206-1.1298340041321353e-10*myi,-0.388887583260777-1.1377032649306784e-10*myi,-0.37565253505635354-1.1464074134437396e-10*myi,-0.3624476360516695-1.155981976808107e-10*myi,-0.34931677349220536-1.1789325071731582e-10*myi,-0.4266432358479504-9.969003400556176e-11*myi,-0.4131944254001585-9.985168247794718e-11*myi,-0.3996444444458893-1.0007283890445251e-10*myi,-0.3860031666055681-1.0035439146349745e-10*myi,-0.3722836503243183-1.00714103723476e-10*myi,-0.35850305985416675-1.0116885107436246e-10*myi,-0.3446838969318833-1.0172129805141594e-10*myi,-0.3308556695551772-1.0232525937681203e-10*myi,-0.3170571863802252-1.0311396181350574e-10*myi,-0.40087824318121124-9.065548312037208e-11*myi,-0.3870286799616509-9.062439687568258e-11*myi,-0.37305689677621334-9.063505501671898e-11*myi,-0.35897068488351636-9.069545114925859e-11*myi,-0.3447807028992944-9.0812690700659e-11*myi,-0.33050133013493443-9.102318898612793e-11*myi,-0.3161518115891475-9.131895239988808e-11*myi,-0.30175781416141945-9.164580205833772e-11*myi,-0.2873535727203489-9.276845958083868e-11*myi};

                // The computation took 38.0936s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f27c_ref[45] = {1.6791188931480354+0.176035647094692*myi,1.8445207172828009+0.22491670644554373*myi,2.039637263807971+0.29730968194630775*myi,2.272896086709195+0.41084782274089404*myi,2.549536785805979+0.601808734589645*myi,2.827806363319306+0.9245760968901244*myi,3.0754663141059595+1.7691695215566483*myi,2.6058034231749705+2.181421117441232*myi,2.279797531379785+2.350344220275119*myi,1.484743676467711+0.11361500496449817*myi,1.6269481151672336+0.14452145433548835*myi,1.793156719131109+0.18988086952137584*myi,1.9904759809253152+0.2601102467789501*myi,2.2257045229267924+0.37613871047342284*myi,2.4857658838282046+0.5765911372455763*myi,3.1416997323708813+0.7601944755598984*myi,2.8440086840698187+1.725913168485203*myi,2.4961456676789524+2.046984350070474*myi,1.3168845149308028+0.07081490948937363*myi,1.4401326832344288+0.08983704116886254*myi,1.582817619753906+0.11762279270003301*myi,1.7508368251793547+0.16039324744905237*myi,1.9511183497668894+0.23067496202722326*myi,2.1833585326977936+0.35426411305347916*myi,2.3452983398140606+0.5171740670821414*myi,2.977072733932623+1.1206774043534402*myi,2.6724361288312366+1.6750448942107994*myi,1.16957799802036+0.04166580412826543*myi,1.2770492135049047+0.052777116063518335*myi,1.4002120709097787+0.06897286248920559*myi,1.5438511429916377+0.09385314550921109*myi,1.714290631468566+0.13474026970042674*myi,1.9165961456360656+0.20774456244040174*myi,2.120944344168538+0.34227779599615715*myi,2.8233710535070475+0.26928476879405494*myi,2.7856818014716183+1.2184027574251957*myi,1.0390818597513611+0.02237301526240776*myi,1.1333078877013394+0.028317910732284512*myi,1.2401166856635362+0.036977789310918*myi,1.3632657540420463+0.05028109592823782*myi,1.5080618886040846+0.07219171884337117*myi,1.6810035995398285+0.11178669807703567*myi,1.8794068499956147+0.19171297494068718*myi,1.8932930155997258+0.26923528871960656*myi,2.7836870826023272+0.6523003925748014*myi};

                // The computation took 42.7845s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                const complex<double> f29c_ref[45] = {4.513856529852124+0.0207355852668627*myi,5.361223602411098+0.046867419372780716*myi,6.624108607271655+0.10225601541733553*myi,8.65620349138604+0.23447062307073452*myi,12.433907173691708+0.6243478653382832*myi,22.821909202485084+2.567179581454365*myi,10.692084535966496+33.60298442326314*myi,-2.8798399539731907+26.463237013362225*myi,-7.824065464593247+21.343149376344343*myi,4.0358639153977585-0.01672342427738016*myi,4.704428485527288-0.011223111902779692*myi,5.677680935841327+0.0045368523830759955*myi,7.181239815332177+0.048603859585540476*myi,9.762725143675464+0.18599482897810304*myi,15.33406642968113+0.7673801354773317*myi,29.98647118915443+28.318563553995926*myi,3.1848420350278523+28.184157826656254*myi,-4.593443179030643+23.166621144288627*myi,3.6495067319840047-0.029840490762190086*myi,4.181776694049864-0.03333773896234149*myi,4.942720134717311-0.0352004613257364*myi,6.081961266976778-0.03016274884331871*myi,7.929399611129133+0.0019154474534452959*myi,11.429867994081569+0.16184551665261893*myi,21.880073581287125+1.51626737880229*myi,11.389018404101098+28.215748987292642*myi,-0.5552453106487576+24.507107317068886*myi,3.337499192173418-0.02912944629051495*myi,3.7645367447525793-0.03510936110315299*myi,4.366798023150222-0.04261492246199339*myi,5.2465829209420045-0.05131691634560376*myi,6.612458463566568-0.057668184411678425*myi,8.985004117418619-0.03886656472050731*myi,14.315559518816258+0.2047904690843776*myi,23.63360332122115+24.05165030208523*myi,4.454180994470647+25.124699774631836*myi,3.0857372777635668-0.021835153585378464*myi,3.430723648432444-0.02704941225633206*myi,3.9127406310524773-0.0342688089151153*myi,4.603748413145579-0.0445117754490898*myi,5.640933373917424-0.059131123402437424*myi,7.331718576160419-0.07784223163139359*myi,10.596647403375428-0.0739379390605599*myi,21.682218300103465+0.7364793070766922*myi,10.808478393410638+24.52304908051292*myi};
*/

                const complex<double> f27d_ref[45] = {4.462519805933196+0.28659888959268875*myi,3.6579187343594284+0.3129262921056326*myi,2.6059311195104105+0.42206006619077774*myi,1.3911743279211244+0.7403937453213882*myi,0.4947208218166242+1.6026287429417103*myi,1.319843818238475+3.884777877878817*myi,13.982066502413579-9.859272187092685*myi,201.46690655810727-92.37577832836641*myi,3371.3792934839003-1132.636471274779*myi,5.23263753909333+0.21250954666503974*myi,4.30508848529041+0.2687178808983648*myi,3.1102955369345664+0.435479627928387*myi,1.7694706656664323+0.8670762949587849*myi,0.9045309088819339+1.9663554052403907*myi,2.6344436776873756+4.859773012493862*myi,1.3270289083134925-4.287137972038057*myi,194.69124870203612-142.20428232671028*myi,3704.6667589205354-1878.688464934644*myi,5.7193726960003906+0.15735261965890102*myi,4.721735570628093+0.2349471962362082*myi,3.4542595011221344+0.4394498696133986*myi,2.072615850030517+0.9398342511245245*myi,1.3224398784526932+2.174981501422588*myi,3.9169173464904112+5.407819441552095*myi,14.252446094584029+14.19323186306649*myi,142.7935407827747-172.35837594470638*myi,3587.867618558565-2562.3332817379082*myi,6.068368154183037+0.11634873612172107*myi,5.026869314311775+0.207346559014849*myi,3.7199565771396386+0.4322608286682557*myi,2.335531558496587+0.9641793626936076*myi,1.7326087513936934+2.251534863450931*myi,5.1482960754038904+5.604825290495338*myi,22.94488308610916+15.387940118362899*myi,36.38404407341403-149.68202024794618*myi,3087.373820509828-3112.6431844325293*myi,6.338703811303942+0.08549507980296811*myi,5.267958577566312+0.1823187606882688*myi,3.939072402392328+0.4118667186014142*myi,2.569802608373635+0.9421276904785195*myi,2.123746820831667+2.2076399252125345*myi,6.308136875984852+5.489895112679932*myi,29.293981204474047+15.306398338238203*myi,76.30397598287546+48.54385782785695*myi,2182.5043535983878-3417.507478535873*myi};

                //part22 {-1.4628645623209828+0.9486650421563406*myi,-1.4618172971428893+0.7319229824970755*myi,-1.5099412682124054+0.4030778909455748*myi,-1.713890920640279-0.06779629426247846*myi,-2.3965505674428953-0.6067461499804607*myi,-4.891392229393193-0.09541385293295179*myi,-13.095115406484245-1.2144324460274163*myi,-53.81711393626897+44.40924115845502*myi,-705.7801449413289+857.77673995647*myi,-2.103685808540914+1.3439683205536026*myi,-2.0595628944918007+1.0962381235782095*myi,-2.0633854675250083+0.7234403890505008*myi,-2.2502210406451533+0.20302173764452147*myi,-3.0289385503155724-0.3511180868459889*myi,-5.777189972167004+0.15850392809289215*myi,-24.3765362045303+1.7896303402201088*myi,-76.03697691454389+68.50936476805973*myi,-998.1292548086349+1259.4817828288192*myi,-2.4240637958800315+1.540292376493468*myi,-2.362829960070442+1.2967228263505923*myi,-2.355875432163163+0.9323521877011669*myi,-2.556933958758822+0.43493070231097875*myi,-3.420404957664825-0.05388756632271585*myi,-6.372954678895314+0.5621456660048958*myi,-16.35738235546955+12.12964901341299*myi,-85.10452454274348+88.3328428920833*myi,-1084.5404624633634+1581.6643436721376*myi,-2.5848086175792298+1.6165161594897268*myi,-2.5129679188874445+1.3948040184656674*myi,-2.5012089470479424+1.0650209238135893*myi,-2.7141153480709916+0.6257013761778675*myi,-3.6279454078069846+0.23745381661691223*myi,-6.688975993559571+0.9783834545788558*myi,-16.244565753245674+10.481157241141274*myi,-87.3998948553865+111.73694856683464*myi,-1023.6731334027528+1858.2919557736373*myi,-2.6514046434956082+1.6014067807372454*myi,-2.5685290133601164+1.4111559055114404*myi,-2.548545863666197+1.1299390757881707*myi,-2.7606039224003345+0.7661665823607942*myi,-3.6866938484077094+0.4908508855091178*myi,-6.7648841643074125+1.3380704039713804*myi,-16.284934831092052+9.91035213232622*myi,-23.317655789495227+102.40019982455465*myi,-813.9738393823072+2104.737377985253*myi};
                //part21 {4.462519805933196+0.28659888959268875*myi,3.6579187343594284+0.3129262921056326*myi,2.6059311195104105+0.42206006619077774*myi,1.3911743279211244+0.7403937453213882*myi,0.4947208218166242+1.6026287429417103*myi,1.319843818238475+3.884777877878817*myi,13.982066502413579-9.859272187092685*myi,201.46690655810727-92.37577832836641*myi,3371.3792934839003-1132.636471274779*myi,5.23263753909333+0.21250954666503974*myi,4.30508848529041+0.2687178808983648*myi,3.1102955369345664+0.435479627928387*myi,1.7694706656664323+0.8670762949587849*myi,0.9045309088819339+1.9663554052403907*myi,2.6344436776873756+4.859773012493862*myi,1.3270289083134925-4.287137972038057*myi,194.69124870203612-142.20428232671028*myi,3704.6667589205354-1878.688464934644*myi,5.7193726960003906+0.15735261965890102*myi,4.721735570628093+0.2349471962362082*myi,3.4542595011221344+0.4394498696133986*myi,2.072615850030517+0.9398342511245245*myi,1.3224398784526932+2.174981501422588*myi,3.9169173464904112+5.407819441552095*myi,14.252446094584029+14.19323186306649*myi,142.7935407827747-172.35837594470638*myi,3587.867618558565-2562.3332817379082*myi,6.068368154183037+0.11634873612172107*myi,5.026869314311775+0.207346559014849*myi,3.7199565771396386+0.4322608286682557*myi,2.335531558496587+0.9641793626936076*myi,1.7326087513936934+2.251534863450931*myi,5.1482960754038904+5.604825290495338*myi,22.94488308610916+15.387940118362899*myi,36.38404407341403-149.68202024794618*myi,3087.373820509828-3112.6431844325293*myi,6.338703811303942+0.08549507980296811*myi,5.267958577566312+0.1823187606882688*myi,3.939072402392328+0.4118667186014142*myi,2.569802608373635+0.9421276904785195*myi,2.123746820831667+2.2076399252125345*myi,6.308136875984852+5.489895112679932*myi,29.293981204474047+15.306398338238203*myi,76.30397598287546+48.54385782785695*myi,2182.5043535983878-3417.507478535873*myi};

                //12346 {0.3349886451107986+3.0720978139205433*myi,0.35968395890848104+3.0243563838401055*myi,0.47699224932946915+2.6931513733540635*myi,0.8523088831543246+0.1366535853434208*myi,1.9311157447937015+0.5628255677334718*myi,0.14122897407250878-1.0992686838475025*myi,-23.111085691226577-15.454243333941886*myi,-123.03673797111941-130.7599882215651*myi,-1272.3708183694744-1628.4300342521815*myi,0.10633538833377898+3.516187432002149*myi,0.11961227655877504+3.4101674577747443*myi,0.2450953240740299-0.6583568489538937*myi,0.6938217096278922+0.31976996999721474*myi,1.8523592415033754+0.6311726933065167*myi,-0.5117340846513865-1.2327591643106635*myi,-24.427035231788647-6.358523544201404*myi,-173.61273517535454-128.68946606437447*myi,-1798.1339039601928-1740.199015293034*myi,-0.07944845662812305+3.812695724536677*myi,-0.07129876317007255+3.6497650810539546*myi,0.06912292892485272-0.6690585626993197*myi,0.6007207760784139+0.4736705856029111*myi,1.7929261823128968+0.6650115598631459*myi,-1.049027764050384-1.2988507010777344*myi,-23.760657082604162-9.236271663251841*myi,-216.45370215156032-108.59908101859293*myi,-2262.3182903705792-1725.2482843744347*myi,-0.24125631223321786+4.021452889334719*myi,-0.23469654403148876-1.486517573254147*myi,-0.07547467260836527-0.6808768749023181*myi,0.5470099133982194+0.6040951402917278*myi,1.7435802584609599+0.6779556146724364*myi,-1.5060946033547618-1.324132058492351*myi,-25.413336748499834-9.41605020376953*myi,-244.86861546905155-56.48497266372084*myi,-2676.767516280487-1611.2075180142288*myi,-0.38809494461814076-2.0825526811779183*myi,-0.3810096418106932-1.587793865017385*myi,-0.20065999905150012-0.6953752166753792*myi,0.5206401470690594+0.7160971937177949*myi,1.699748707950226+0.67714032003376*myi,-1.9030658910392224-1.322539686423399*myi,-26.939924961710222-9.404726668050671*myi,-207.61993442601405-52.90158759061942*myi,-3045.0939359686267-1394.6810319916792*myi};
                //1346 {-2.6646665985014133+1.8368338821715144*myi,-1.8364174783080607+1.9795071092373981*myi,-0.6189976019685348+1.8680134162177098*myi,1.17502547587348-0.5359438657154889*myi,3.8329454904199722-0.433057025227778*myi,3.712777385227227-4.888632708793366*myi,-23.99803678715591-4.380538700821791*myi,-270.6865305929576-82.79345105165375*myi,-3937.9699669120455-1353.5703029338713*myi,-3.0226163422186385+1.9597095647835086*myi,-2.125913314239834+2.0452114532981707*myi,-0.8018147453355287-1.8172768659327816*myi,1.1745720846066128-0.7503280626060913*myi,3.9767668829370133-0.9840646250878842*myi,2.6310122098282402-6.251036104897417*myi,-1.377527935571826-3.8610159123834507*myi,-292.2670069628467-54.99454850572391*myi,-4504.671408072092-1120.9923331872087*myi,-3.3747573567484803+2.1150507283843067*myi,-2.430204373727724+2.118095058467153*myi,-1.0292611400341185-2.040860620013884*myi,1.0850388848067194-0.9010943678325921*myi,3.890891261525029-1.4560823752367251*myi,1.4070095683545192-7.268815808634725*myi,-21.655720821718642-35.55915253973133*myi,-274.14271839159153-24.57354796596985*myi,-4765.645446465781-744.5793463086642*myi,-3.724815848837027+2.2885879937232705*myi,-2.7485979394558173-3.088668150734664*myi,-1.2942223027000619-2.178158627384163*myi,0.9255937029726242-0.9857855985797471*myi,3.638916914874252-1.8110330653954074*myi,0.03458531480091742-7.907340803566544*myi,-32.11365408136332-35.28514756327371*myi,-193.85276468707914-18.539900982609367*myi,-4740.468203387562-356.85628935533714*myi,-4.075394112426475-3.769454541718134*myi,-3.0804392060168873-3.1812685312170945*myi,-1.59118653777763-2.237181011064964*myi,0.7114414610957578-0.9921970791215193*myi,3.2626957355262682-2.021350490687893*myi,-1.4463186027166641-8.150505203074713*myi,-39.94897133509221-34.62147713861509*myi,-260.60625461939435-203.84564524303107*myi,-4413.624450184709-81.91093144105798*myi};
                //136 {-2.517463489845114+1.6732540609250122*myi,-1.6775536556695707+1.826397659200691*myi,-0.45806889994299826+1.744219501646248*myi,1.3091561962030602-0.4735512509557309*myi,3.859054268028971-0.4330570250032886*myi,3.765300122383713-4.888632708319058*myi,-22.724428472918653-3.3888876496324833*myi,-265.84714407619094-75.03359802152386*myi,-3893.8191114061556-1262.880614547728*myi,-3.1685447898854573+2.119705479621167*myi,-2.283149013879952+2.1919495210863573*myi,-0.9601523280113655-1.9310956570825106*myi,1.046170239963931-0.7991682612996973*myi,3.9550064252870873-0.9840646249432643*myi,2.58984273943012-6.251036104632383*myi,-2.73252395891633-3.8637707723750054*myi,-298.9105795136254-61.5613881405218*myi,-4565.364144538338-1203.7800139708468*myi,-3.8045582812097205+2.578838084114194*myi,-2.892661858921481+2.5364144166404756*myi,-1.4924562376648431-2.3539112714252277*myi,0.7195721646767215-1.0144201327086417*myi,3.8340151125473843-1.4560823751354377*myi,1.3024436518402125-7.268815808462668*myi,-24.100010621610437-35.55915253682055*myi,-298.3132037089671-39.20489754186457*myi,-4984.689848023009-962.1589585063678*myi,-4.4262030801083+3.033197630674759*myi,-3.502290257119145-3.7506656643195035*myi,-2.0452841789233096-2.6577307242659485*myi,0.3495568926261914-1.1291680778770035*myi,3.554111550659127-1.8110330653218196*myi,-0.11881955382964704-7.90734080344922*myi,-35.480063532099294-35.28514756165691*myi,-240.6718562446678-28.444041000750616*myi,-5153.86287776243-660.3522058518665*myi,-5.036422529166074-4.77351734509171*myi,-4.11183640148931-4.06253116592587*myi,-2.613972199675943-2.8565433623053456*myi,-0.04977201405737919-1.1397133634143324*myi,3.1545678976361136-2.0213504906338056*myi,-1.6399344224511843-8.150505202994479*myi,-44.053836491422224-34.62147713777294*myi,-303.54832307894844-203.8456452599732*myi,-5047.310757886334-410.36348042034297*myi};
                //16 {-0.7835309243001651-0.6611812875749261*myi,0.18878285683256557-0.3863920079213077*myi,1.4303046316500048-0.08724297204945786*myi,2.8848271067273554+0.08629820245043063*myi,4.1552077784627945-0.4958222689765891*myi,4.306452563349454-5.149855507914464*myi,3.0258279580047187+2.246747166744484*myi,-136.50421314472487+25.972846174773537*myi,-2614.989877876331+177.8679901162767*myi,-0.689121229217097-0.8136254379866332*myi,0.37024461811376863-0.522045584625835*myi,1.694716788097332-0.22876349912180716*myi,3.1869393287114716-0.1365168521005478*myi,4.311179414433681-1.0280002547160967*myi,3.235963212016878-6.398900549837187*myi,23.537359983548377-13.454621070263958*myi,-107.87062071795313+36.631334858697016*myi,-2646.531224138069+460.37700315204074*myi,-0.6515738993391329-0.8311950909163905*myi,0.46610946650532536-0.5573967815437785*myi,1.8375907316018565-0.31014577780782226*myi,3.3220537513266013-0.3292170272149376*myi,4.237838638803568-1.4846363841043693*myi,2.033064628559142-7.356220741229624*myi,-7.856713484140305-40.08182295486182*myi,-50.98293335252625+28.878092951481733*myi,-2443.525893494121+751.5182972100429*myi,-0.6534610431866845-0.777206269864094*myi,0.5011885325285546-0.5360342597018344*myi,1.8926717036204446-0.34791292550233455*myi,3.3349689135520317-0.47534514643389936*myi,3.9981961071582486-1.8272565145799369*myi,0.6839999834168191-7.955108890524063*myi,-18.184855421104704-37.26028134735656*myi,46.91036683128393-42.441152658947686*myi,-2015.6026381215122+943.857712895529*myi,-0.6867398264076847-0.6691475570577328*myi,0.4883876012495634-0.4660551887431186*myi,1.8790930756157493-0.33762939507486367*myi,3.2532671719966015-0.5557688313078588*myi,3.633886247566439-2.0277244851669383*myi,-0.7734462436661236-8.17016446680922*myi,-25.68356615736885-35.41613582345779*myi,-117.30353948246898-230.7558975906727*myi,-1347.928768948309+903.0953902522269*myi};
                //1 {-2.1486244914939885-1.5784863777102687*myi,-1.166897517210689-1.3870688923985635*myi,0.18853679051970484-1.1401549528439077*myi,1.9544828365312736-0.9103885794685087*myi,3.8336323333197466-1.0800235091511095*myi,4.036432772248146-3.8341526522182363*myi,-4.634833763224458-7.8119159649169365*myi,-133.67256140377515-51.895547783334166*myi,-2298.343683387182-766.0287725827948*myi,-2.5704352342470678-1.9572539302337244*myi,-1.49327113937869-1.7634701720833805*myi,-0.011893846536588981-1.5255114984302456*myi,1.895381764441383-1.3490770826850524*myi,3.8291633691343177-1.7203659204227655*myi,3.334548890581586-4.990895017626158*myi,0.6836864460031471-18.669987762060238*myi,-142.33602838790713-73.94436408010638*myi,-2537.3906049774505-987.9324626976551*myi,-2.9817824141290696-2.1128534669716452*myi,-1.8382732128828803-1.942666340752318*myi,-0.27356300222261876-1.7483234776194507*myi,1.711896344519575-1.6611448420713697*myi,3.60912698622539-2.2315155108952505*myi,2.4126126166775173-5.910857289459518*myi,-18.172412388812067-28.23293538580552*myi,-147.09277911386113-96.00750269905905*myi,-2742.5689199599833-1132.5302303853578*myi,-3.3768426541641965-2.1324003374078395*myi,-2.1882427266420486-1.9952081120909253*myi,-0.5715812816103325-1.8548553566901074*myi,1.4454346308985349-1.8599537342749035*myi,3.239327873769092-2.593156157360794*myi,1.2957931456899732-6.517540646374579*myi,-23.980896881977195-27.026650296139454*myi,-144.13856765341262-136.0271070784675*myi,-2923.3159483981844-1249.526800180694*myi,-3.754877308950168-2.0488187935085884*myi,-2.5371625904310147-1.9466792685711025*myi,-0.8922148869613435-1.8598624978116496*myi,1.121278047225816-1.945290068185643*myi,2.7622185413818188-2.788201121342145*myi,0.03082672522354768-6.772414989039603*myi,-29.23649118379096-26.079926019058334*myi,-254.13560024891157-171.5889627591302*myi,-3086.2210062322843-1382.0507855096328*myi};

                const complex<double> f29d_ref[45] = {7.367673368083917+5.56270158314312*myi,7.119750716765626+5.424439454024437*myi,6.851637268164385+5.228076626438579*myi,6.876506954716152+5.106302321131862*myi,8.508392270067716+5.6520484481595155*myi,19.16937581587287+9.435383555448366*myi,28.95620071124323+61.04628062262866*myi,129.52185932182078+183.87557624795232*myi,2023.3096105404484+1608.155796577263*myi,9.802977830925064+4.622416180696061*myi,9.542053649601181+4.6868604332132335*myi,9.293401981946364+4.791767277520011*myi,9.481567053194565+5.0993161986788635*myi,11.740575217820297+6.186407280421212*myi,23.31770937565402+10.298781404571105*myi,73.18118486244185+87.82813130352159*myi,191.0005530451417+191.2183166907857*myi,2694.4820338970585+1082.928865521399*myi,11.524625596292292+3.92174444791286*myi,11.311757721969677+4.099564842440808*myi,11.163145950835766+4.37272262617816*myi,11.593970617670603+4.914591143113422*myi,14.470804846374463+6.272805422370732*myi,27.311570808888938+10.429544275146467*myi,95.01281534747079+26.360079866760103*myi,250.08473424999465+223.8545782347874*myi,3061.0658367271135+791.1990925355476*myi,12.854592075602463+3.329726980138516*myi,12.710457859603624+3.567159216529783*myi,12.685732648556742+3.9284247758121826*myi,13.37091506868204+4.585942158691796*myi,16.816876600592572+6.045815547569456*myi,30.882627725661877+10.045937652232372*myi,94.01261616751889+24.155655767169108*myi,356.9284317082207+295.9987142046686*myi,3276.4244640742227+686.0423891838689*myi,13.93113412870685+2.7911483356202655*myi,13.860824877003001+3.0511727678661895*myi,13.96270634789319+3.445303506492368*myi,14.890792198031296+4.13594015481488*myi,18.848522671865727+5.576578954753695*myi,34.03497171958718+9.263546727342254*myi,98.13467901057444+21.509145827877912*myi,502.2062717138326+82.58902672569181*myi,3439.1238207203182+789.8574446315467*myi};
                //{-2.0027456725572677-1.1858938497866234e-8*myi,-2.017764569662959-1.0049342080709067e-8*myi,-1.9551031346273127-7.512437005807726e-9*myi,-1.7251035783273116-4.279736676160439e-9*myi,-1.0125323505390194-1.1390868803751175e-9*myi,3.275390418330374+6.755806136737874e-9*myi,-20.645515535703577+31.600474131162457*myi,-140.00431530805446+23.87273362568066*myi,-1444.7946289597267-450.66664944510956*myi,0.44810382735819987-7.056164791352515e-9*myi,0.05675697491808851-5.9630410331745765e-9*myi,-0.4042058040747625-4.471172238007526e-9*myi,-0.8384601139187273-2.609271486375686e-9*myi,-0.7795135013807305-7.539119190047572e-10*myi,2.4749728757535037+1.8422994241262813e-9*myi,16.296073517097916+59.72014617507172*myi,-80.36190954660789+57.13310712236689*myi,-544.458184535235-517.491380090614*myi,2.0947967085039787-4.79355480309529e-9*myi,1.4543599507639344-4.034292289123442e-9*myi,0.6489406803544215-3.0255190019978784e-9*myi,-0.22315672467252412-1.7914907597758184e-9*myi,-0.612146780518817-5.414833373351691e-10*myi,2.233746590071953+8.884224467209378e-10*myi,31.630041427719615+7.184094386047946e-8*myi,-25.469189590818615+109.25524812371032*myi,-23.20439734615252-491.5092017627794*myi,3.3267636061946786-3.489046994588435e-9*myi,2.5032302575819187-2.918039219458487e-9*myi,1.4447637507669386-2.1809406629544813e-9*myi,0.2484967662984261-1.3007281194396155e-9*myi,-0.4828881701848557-4.0655752711347534e-10*myi,2.1367361471425577+5.689433368871732e-10*myi,24.892551452064833+1.6143748560182303e-8*myi,76.68034981723116+198.0593353942364*myi,309.45868009366075-350.8345975038087*myi,4.307819188106658-2.6434863742430537e-9*myi,3.3409982849046695-2.190977288485385e-9*myi,2.083996683006358-1.6252526546800539e-9*myi,0.6309070526603985-9.704420808609449e-10*myi,-0.378393681581069-3.13173409514228e-10*myi,2.096136197902645+4.3600190124948313e-10*myi,23.97549460330337+7.483609509861822e-9*myi,217.4560140972909+5.351200300651726e-7*myi,567.9261018946668-42.905364288624355*myi};

                // The computation took 5.55759s AbsoluteTiming with the Mathematica-Ginac script from [AGV:2019A]
                // feynepsilonhat = 1e-10
                const complex<double> f29e_ref[45] = {2.3021828027409255 - 6.463426460712185e-10 * myi, 2.385948579526878 - 1.044983460873894e-9 * myi, 2.700100154127618 - 1.5445331680297159e-9 * myi, 3.6163362509571346 - 1.932085602618372e-9 * myi, 6.666877489981057 + 2.8917135352912737e-10 * myi, 28.623209566833367 + 9.837709313842424e-8 * myi, -48.40967194198186 - 5.577487933474039 * myi, -16.874156506724486 - 14.088669006050232 * myi, -8.120489514625849 - 13.065461479444517 * myi, 2.3891251350058544 - 1.0545575523934758e-10 * myi, 2.53201813513229 - 2.763216322421158e-10 * myi, 2.905754685469725 - 4.0957903735261425e-10 * myi, 3.8132032921355905 - 2.3579538321882865e-10 * myi, 6.262937168090792 + 1.854425946135052e-9 * myi, 16.09708865543818 + 2.5199682340826257e-8 * myi, -139.6018251283025 + 89.57165539021763 * myi, -34.10106085600972 - 12.77883576501469 * myi, -16.18476485749127 - 15.329293002930044 * myi, 2.360596786243271 + 2.0758150753863447e-10 * myi, 2.5208807225145855 + 1.4876189169399368e-10 * myi, 2.8920338899305498 + 1.6927081958328927e-10 * myi, 3.710589948855498 + 4.959286314942801e-10 * myi, 5.655080738092669 + 2.130152054746759e-9 * myi, 11.553725232419755 + 1.2162026052919828e-8 * myi, 58.30623682360957 + 3.0637617953743757e-7 * myi,-62.76950940050142 + 0.031852335768391526 * myi, -27.510523556251457 - 15.546163093825761 * myi, 2.2611611038878188 + 3.9498049275721314e-10 * myi, 2.417885207731062 + 3.929780945099992e-10 * myi, 2.7603235654499256 + 4.773212936015625e-10 * myi, 3.4718374685672275 + 8.230784942497849e-10 * myi, 5.022765191422876 + 2.0671784284331807e-9 * myi, 8.99999956749037 + 7.480778663193632e-9 * myi, 25.235965138100266 + 5.594193908109446e-8 * myi, -129.21960318321723 + 67.6483365255224 * myi, -43.80351847021929 - 11.716589533222155 * myi, 2.1167522450187013 + 5.073221842621933e-10 * myi, 2.2593251623889987 + 5.336877606509915e-10 * myi, 2.5628117869741036 + 6.408615860209466e-10 * myi, 3.1698959791101298 + 9.60874046995741e-10 * myi, 4.4158702116722175 + 1.9111201510213505e-9 * myi, 7.274234695054613 + 5.2121578164587845e-9 * myi, 15.966659039855655 + 2.29688197350697e-8 * myi, 104.86751778726 + 8.100933825971879e-7 * myi, -69.40585654227208 + 1.840951225135683 * myi};

                // feynepsilonhat = 1e-14
                //const complex<double> f29ev2_ref[45] = {2.302182802740934 - 6.583622536027178e-14*myi,2.3859485795268744 - 1.0219602941674566e-13*myi, 2.700100154127613 - 1.5587531265737198e-13*myi,3.6163362509571346 - 1.8740564655672642e-13*myi, 6.66687748998105 + 3.019806626980426e-14*myi,28.623209566833353 + 9.833911462919787e-12*myi, -48.40967203064752 - 5.577488119383567*myi,-16.87415650098007 - 14.088669061363333*myi, -8.120489503002077 - 13.065461506979855*myi,2.38912513500586 - 1.2323475573339238e-14*myi, 2.532018135132292 - 2.7533531010703882e-14*myi,2.90575468546973 - 4.796163466380676e-14*myi, 3.8132032921355923 - 2.7533531010703882e-14*myi,6.2629371680907635 + 1.3855583347321954e-13*myi, 16.09708865543817 + 2.5579538487363607e-12*myi,-139.6018264704346 + 89.57165452714135*myi, -34.10106087706429 - 12.778835852309772*myi,-16.18476485202037 - 15.329293041771372*myi, 2.360596786243269 + 2.7977620220553945e-14*myi,2.5208807225145855 + 1.509903313490213e-14*myi, 2.892033889930551 + 1.0658141036401503e-14*myi,3.7105899488554925 + 5.1514348342607263e-14*myi, 5.65508073809269 + 1.5987211554602254e-13*myi,11.55372523241972 + 1.2647660696529783e-12*myi, 58.30623682360959 + 3.065281362069072e-11*myi,-62.76950950082173 + 0.031852180036352706*myi, -27.510523562152954 - 15.546163148512225*myi,2.2611611038878183 + 4.75175454539567e-14*myi, 2.417885207731071 + 4.3520742565306136e-14*myi,2.760323565449924 + 3.730349362740526e-14*myi, 3.4718374685672426 + 6.572520305780927e-14*myi,5.022765191422869 + 2.5934809855243657e-13*myi, 8.999999567490438 + 7.744915819785092e-13*myi,25.235965138100273 + 5.5990767577895895e-12*myi, -129.21960387622306 + 67.64833601689656*myi,-43.80351849993297 - 11.716589613824716*myi, 2.1167522450187004 + 5.773159728050814e-14*myi,2.2593251623889863 + 6.128431095930864e-14*myi, 2.5628117869741107 + 7.016609515630989e-14*myi,3.169895979110128 + 1.2079226507921703e-13*myi, 4.415870211672161 + 2.327027459614328e-13*myi,7.274234695054517 + 4.831690603168681e-13*myi, 15.966659039855637 + 2.3092638912203256e-12*myi,104.86751778725996 + 8.100187187665142e-11*myi, -69.40585663652078 + 1.840951089440921*myi};

                for (unsigned int i = 0; i < 45; i++)
                {
                    const double z = z_s_list[i][0];
                    const complex<double> s = z_s_list[i][1];
                    agv_2019a::CharmLoopsParameters testclp = {/*muhat =*/ 1.0, /*s =*/ s, /*z =*/ z, /*feynepsilonhat*/ 1e-10};

                    // const complex<double> f27a_res = agv_2019a::f27a(testclp);
                    // const complex<double> f29a_res = agv_2019a::f29a(testclp);

                    // const complex<double> f27b_res = agv_2019a::f27b(testclp);
                    // const complex<double> f29b_res = agv_2019a::f29b(testclp);

                    // const complex<double> f27c_res = agv_2019a::f27c(testclp);
                    // const complex<double> f29c_res = agv_2019a::f29c(testclp);

                    //const complex<double> f27d_res = agv_2019a::f27d(testclp);
                    const complex<double> f29d_res = agv_2019a::f29d(testclp);

                    const complex<double> f29e_res = agv_2019a::f29e(testclp);


                    // TEST_CHECK_NEARLY_EQUAL(f27a_ref[i].real(), f27a_res.real(), eps);
                    // TEST_CHECK_NEARLY_EQUAL(f27a_ref[i].imag(), f27a_res.imag(), eps);

                    // TEST_CHECK_NEARLY_EQUAL(f29a_ref[i].real(), f29a_res.real(), eps);
                    // TEST_CHECK_NEARLY_EQUAL(f29a_ref[i].imag(), f29a_res.imag(), eps);

                    // TEST_CHECK_NEARLY_EQUAL(f27b_ref[i].real(), f27b_res.real(), 12*eps);
                    // TEST_CHECK_NEARLY_EQUAL(f27b_ref[i].imag(), f27b_res.imag(), 12*eps);

                    // TEST_CHECK_NEARLY_EQUAL(f29b_ref[i].real(), f29b_res.real(), 30*eps);
                    // TEST_CHECK_NEARLY_EQUAL(f29b_ref[i].imag(), f29b_res.imag(), 30*eps);

                    // TEST_CHECK_NEARLY_EQUAL(f27c_ref[i].real(), f27c_res.real(), 5*eps);
                    // TEST_CHECK_NEARLY_EQUAL(f27c_ref[i].imag(), f27c_res.imag(), 5*eps);

                    // TEST_CHECK_NEARLY_EQUAL(f29c_ref[i].real(), f29c_res.real(), 150*eps);
                    // TEST_CHECK_NEARLY_EQUAL(f29c_ref[i].imag(), f29c_res.imag(), 150*eps);

                    // TEST_CHECK_NEARLY_EQUAL(f27d_ref[i].real(), f27d_res.real(), 50*eps);
                    // TEST_CHECK_NEARLY_EQUAL(f27d_ref[i].imag(), f27d_res.imag(), 50*eps);

                    TEST_CHECK_NEARLY_EQUAL(f29d_ref[i].real(), f29d_res.real(), 50*eps);
                    TEST_CHECK_NEARLY_EQUAL(f29d_ref[i].imag(), f29d_res.imag(), 50*eps);

                    TEST_CHECK_NEARLY_EQUAL(f29e_ref[i].real(), f29e_res.real(), eps);
                    TEST_CHECK_NEARLY_EQUAL(f29e_ref[i].imag(), f29e_res.imag(), eps);
                }
            }
        }
} two_loop_test ;
